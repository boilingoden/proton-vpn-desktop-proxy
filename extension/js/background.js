!function(){var e={310:function(e){"use strict";e.exports={appVersion:"1.2.6",appId:"jplgfhpmjnbigmhklmmbgecoobifkmpa",baseDomainURL:"https://account.proton.me",tokenDuration:1200,proxyHost:null,proxyPort:4443,singleProxyPort:!1,proxySecureCorePort:443,scheme:"https",apiDomainsExclusion:[],proxyLocalNetworkExclusion:["localhost","127.0.0.1","127.0.0.0/8","127.0.0.1:80","10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","[::1]","<local>"],signupEnabled:!0,torEnabled:!1,sentry:"https://5c4abb94f5a644b38cf8e3261dfad0e3@reports.proton.me/api/core/v4/reports/sentry/67"}},430:function(e,t,n){e.exports=n(627)},627:function(e,t){"use strict";var n=/(\w+)[-_].*/;function r(e,t){if(t[e])return t[e];var r=e.match(n);if(!r)throw new Error("Can't find lang or lcale with code "+e);return t[r[1]]}function o(e){return e>1}function i(e){return 1!==e}function a(e){return 0}var s={ach:{n:2,f:o},af:{n:2,f:i},ak:{n:2,f:o},am:{n:2,f:o},an:{n:2,f:i},ar:{n:6,f:function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5}},arn:{n:2,f:o},ast:{n:2,f:i},ay:{n:1,f:a},az:{n:2,f:i},be:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},bg:{n:2,f:i},bn:{n:2,f:i},bo:{n:1,f:a},br:{n:2,f:o},brx:{n:2,f:i},bs:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},ca:{n:2,f:i},cgg:{n:1,f:a},cs:{n:3,f:function(e){return 1===e?0:e>=2&&e<=4?1:2}},csb:{n:3,f:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},cy:{n:4,f:function(e){return 1===e?0:2===e?1:8!==e&&11!==e?2:3}},da:{n:2,f:i},de:{n:2,f:i},doi:{n:2,f:i},dz:{n:1,f:a},el:{n:2,f:i},en:{n:2,f:i},eo:{n:2,f:i},es:{n:2,f:i},et:{n:2,f:i},eu:{n:2,f:i},fa:{n:1,f:a},ff:{n:2,f:i},fi:{n:2,f:i},fil:{n:2,f:o},fo:{n:2,f:i},fr:{n:2,f:function(e){return e<=-2||e>=2}},fur:{n:2,f:i},fy:{n:2,f:i},ga:{n:5,f:function(e){return 1===e?0:2===e?1:e<7?2:e<11?3:4}},gd:{n:4,f:function(e){return 1===e||11===e?0:2===e||12===e?1:e>2&&e<20?2:3}},gl:{n:2,f:i},gu:{n:2,f:i},gun:{n:2,f:o},ha:{n:2,f:i},he:{n:2,f:i},hi:{n:2,f:i},hne:{n:2,f:i},hr:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},hu:{n:2,f:i},hy:{n:2,f:i},id:{n:1,f:a},is:{n:2,f:function(e){return e%10!=1||e%100==11}},it:{n:2,f:i},ja:{n:1,f:a},jbo:{n:1,f:a},jv:{n:2,f:function(e){return 0!==e}},ka:{n:1,f:a},kab:{n:2,f:i},kk:{n:2,f:i},km:{n:1,f:a},kn:{n:2,f:i},ko:{n:1,f:a},ku:{n:2,f:i},kw:{n:4,f:function(e){return 1===e?0:2===e?1:3===e?2:3}},ky:{n:1,f:a},lb:{n:2,f:i},ln:{n:2,f:o},lo:{n:1,f:a},lt:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2}},lv:{n:3,f:function(e){return e%10==1&&e%100!=11?0:0!==e?1:2}},mai:{n:2,f:i},mfe:{n:2,f:o},mg:{n:2,f:o},mi:{n:2,f:o},mk:{n:2,f:function(e){return 1===e||e%10==1?0:1}},ml:{n:2,f:i},mn:{n:2,f:i},mni:{n:2,f:i},mnk:{n:3,f:function(e){return 0===e?0:1===e?1:2}},mr:{n:2,f:i},ms:{n:1,f:a},mt:{n:4,f:function(e){return 1===e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3}},my:{n:1,f:a},nah:{n:2,f:i},nap:{n:2,f:i},nb:{n:2,f:i},ne:{n:2,f:i},nl:{n:2,f:i},nn:{n:2,f:i},no:{n:2,f:i},nso:{n:2,f:i},oc:{n:2,f:o},or:{n:2,f:i},pa:{n:2,f:i},pap:{n:2,f:i},pl:{n:3,f:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},pms:{n:2,f:i},ps:{n:2,f:i},pt:{n:2,f:i},rm:{n:2,f:i},ro:{n:3,f:function(e){return 1===e?0:0===e||e%100>0&&e%100<20?1:2}},ru:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},rw:{n:2,f:i},sah:{n:1,f:a},sat:{n:2,f:i},sco:{n:2,f:i},sd:{n:2,f:i},se:{n:2,f:i},si:{n:2,f:i},sk:{n:3,f:function(e){return 1===e?0:e>=2&&e<=4?1:2}},sl:{n:4,f:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0}},so:{n:2,f:i},son:{n:2,f:i},sq:{n:2,f:i},sr:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},su:{n:1,f:a},sv:{n:2,f:i},sw:{n:2,f:i},ta:{n:2,f:i},te:{n:2,f:i},tg:{n:2,f:o},th:{n:1,f:a},ti:{n:2,f:o},tk:{n:2,f:i},tr:{n:2,f:o},tt:{n:1,f:a},ug:{n:1,f:a},uk:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},ur:{n:2,f:i},uz:{n:2,f:o},vi:{n:1,f:a},wa:{n:2,f:o},wo:{n:1,f:a},yo:{n:2,f:i},zh:{n:1,f:a}};var c={};t.getPluralFunc=function(e){if(c[e])return c[e];var t=r(e,s),n=function(e,n){return n[+t.f(e)]};return c[e]=n,n}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e,t=n(310),r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},i=t.appVersion,a=t.appId,s=t.baseDomainURL,c="".concat(s,"/").concat(""),u=("".concat(c,"vpn/dashboard"),"".concat(s,"/api/")),l=new URL(u).hostname,f=!0,d=t.sentry,p=o([l],r(t.apiDomainsExclusion),!1),h=t.proxyLocalNetworkExclusion,v=t.signupEnabled,y=t.torEnabled,b=t.tokenDuration,m=Math.floor(b/4),g=t.proxyHost,w=t.proxyPort,_=t.singleProxyPort,x=t.proxySecureCorePort,S=t.scheme,E=function(){return E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},E.apply(this,arguments)},k=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},P=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){e.LOCAL="local",e.SYNC="sync",e.SESSION="session"}(e||(e={}));var O=e.LOCAL,T=O,I=function(t){return t===e.LOCAL?localStorage:sessionStorage},C={getDefinedItem:function(e,t,n){return void 0===n&&(n=O),k(this,void 0,void 0,(function(){return P(this,(function(r){switch(r.label){case 0:return[4,this.getItem(e,t,n)];case 1:return[2,r.sent()||t]}}))}))},getItem:function(t,n,r){return void 0===n&&(n=void 0),void 0===r&&(r=O),k(this,void 0,void 0,(function(){var o,i,a,s,c,u;return P(this,(function(l){switch(l.label){case 0:o="bex-"+t,l.label=1;case 1:return l.trys.push([1,5,,10]),[4,new Promise((function(e){chrome.storage[r].get(o,e)}))];case 2:return"object"==typeof(i=l.sent())&&i.hasOwnProperty(o)?[2,i[o]]:r===e.LOCAL&&e.SESSION in chrome.storage?[4,new Promise((function(t){chrome.storage[e.SESSION].get(o,t)}))]:[3,4];case 3:if("object"==typeof(a=l.sent())&&a.hasOwnProperty(o))return[2,a[o]];l.label=4;case 4:return[2,n];case 5:l.sent(),s=I(r),l.label=6;case 6:return l.trys.push([6,8,,9]),[4,s.getItem(o)];case 7:return"string"==typeof(c=l.sent())?[2,JSON.parse(c)]:[2,n];case 8:return l.sent(),[2,(u=window.bexStorage||(window.bexStorage={})).hasOwnProperty(t)?u[t]:n];case 9:return[3,10];case 10:return[2]}}))}))},setItem:function(e,t,n){return void 0===n&&(n=O),k(this,void 0,void 0,(function(){var r,o,i;return P(this,(function(a){switch(a.label){case 0:r="bex-"+e,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,chrome.storage[n].set((i={},i[r]=t,i))];case 2:return a.sent(),[3,4];case 3:a.sent(),o=JSON.stringify(t);try{I(n).setItem(r,o)}catch(n){(window.bexStorage||(window.bexStorage={}))[e]=t}return[3,4];case 4:return[2]}}))}))},removeItem:function(e,t){return void 0===t&&(t=O),k(this,void 0,void 0,(function(){var n;return P(this,(function(r){switch(r.label){case 0:n="bex-"+e,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,chrome.storage[t].remove(n)];case 2:return r.sent(),[3,4];case 3:r.sent();try{I(t).removeItem(n)}catch(t){delete(window.bexStorage||(window.bexStorage={}))[e]}return[3,4];case 4:return[2]}}))}))},item:function(e,t,n){void 0===t&&(t=O),void 0===n&&(n="value");var r=this;return{key:e,get:function(n){return void 0===n&&(n=void 0),r.getItem(e,n,t)},getDefined:function(n){return r.getDefinedItem(e,n,t)},load:function(n){return void 0===n&&(n=void 0),k(this,void 0,void 0,(function(){var o;return P(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,r.getItem(e,n,t)];case 1:return[2,"object"==typeof(o=i.sent())?o:{}];case 2:return i.sent(),[2,{}];case 3:return[2]}}))}))},set:function(n){return r.setItem(e,n,t)},setValue:function(e,t){var r;return void 0===t&&(t={}),this.set(E(((r={time:Date.now()})[n]=e,r),t))},remove:function(){return r.removeItem(e,t)}}},selfItem:function(e,t){return void 0===t&&(t=O),this.item(e,t,e)}};const D="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,N="8.55.0",L=globalThis;function A(e,t,n){const r=n||L,o=r.__SENTRY__=r.__SENTRY__||{},i=o[N]=o[N]||{};return i[e]||(i[e]=t())}const j=["debug","info","warn","error","log","assert","trace"],R={};function M(e){if(!("console"in L))return e();const t=L.console,n={},r=Object.keys(R);r.forEach((e=>{const r=R[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}const $=A("logger",(function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return D?j.forEach((n=>{t[n]=(...t)=>{e&&M((()=>{L.console[n](`Sentry Logger [${n}]:`,...t)}))}})):j.forEach((e=>{t[e]=()=>{}})),t})),U=L;function G(){if(!("fetch"in U))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function q(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}const F="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,H=L,B={};function V(e){const t=B[e];if(t)return t;let n=H[e];if(q(n))return B[e]=n.bind(H);const r=H.document;if(r&&"function"==typeof r.createElement)try{const t=r.createElement("iframe");t.hidden=!0,r.head.appendChild(t);const o=t.contentWindow;o&&o[e]&&(n=o[e]),r.head.removeChild(t)}catch(t){F&&$.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?B[e]=n.bind(H):n}function z(e){B[e]=void 0}const Y=Object.prototype.toString;function W(e){switch(Y.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return oe(e,Error)}}function J(e,t){return Y.call(e)===`[object ${t}]`}function K(e){return J(e,"ErrorEvent")}function X(e){return J(e,"DOMError")}function Z(e){return J(e,"String")}function Q(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function ee(e){return null===e||Q(e)||"object"!=typeof e&&"function"!=typeof e}function te(e){return J(e,"Object")}function ne(e){return"undefined"!=typeof Event&&oe(e,Event)}function re(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function oe(e,t){try{return e instanceof t}catch(e){return!1}}function ie(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}var ae;function se(e){return new ue((t=>{t(e)}))}function ce(e){return new ue(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(ae||(ae={}));class ue{constructor(e){ue.prototype.__init.call(this),ue.prototype.__init2.call(this),ue.prototype.__init3.call(this),ue.prototype.__init4.call(this),this._state=ae.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new ue(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new ue(((t,n)=>{let r,o;return this.then((t=>{o=!1,r=t,e&&e()}),(t=>{o=!0,r=t,e&&e()})).then((()=>{o?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(ae.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(ae.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===ae.PENDING&&(re(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===ae.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===ae.RESOLVED&&e[1](this._value),this._state===ae.REJECTED&&e[2](this._value),e[0]=!0)}))}}}const le="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,fe=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function de(e,t=!1){const{host:n,path:r,pass:o,port:i,projectId:a,protocol:s,publicKey:c}=e;return`${s}://${c}${t&&o?`:${o}`:""}@${n}${i?`:${i}`:""}/${r?`${r}/`:r}${a}`}function pe(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function he(e){const t="string"==typeof e?function(e){const t=fe.exec(e);if(!t)return void M((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,o="",i="",a="",s=""]=t.slice(1);let c="",u=s;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return pe({host:i,pass:o,path:c,projectId:u,port:a,protocol:n,publicKey:r})}(e):pe(e);if(t&&function(e){if(!D)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&($.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&($.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):($.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):($.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}const ve=L;function ye(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let i=0,a=0;const s=" > ",c=s.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,f=!Array.isArray(t)&&t.maxStringLength||80;for(;n&&i++<r&&(u=be(n,l),!("html"===u||i>1&&a+o.length*c+u.length>=f));)o.push(u),a+=u.length,n=n.parentNode;return o.reverse().join(s)}catch(e){return"<unknown>"}}function be(e,t){const n=e,r=[];if(!n||!n.tagName)return"";if(ve.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const o=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(o&&o.length)o.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&Z(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const i=["aria-label","type","name","title","alt"];for(const e of i){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}function me(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function ge(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{ie(r)?n.push("[VueViewModel]"):n.push(String(r))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function we(e,t,n=!1){return!!Z(e)&&(J(t,"RegExp")?t.test(e):!!Z(t)&&(n?e===t:e.includes(t)))}function _e(e,t=[],n=!1){return t.some((t=>we(e,t,n)))}function xe(e,t,n){if(!(t in e))return;const r=e[t],o=n(r);"function"==typeof o&&Ee(o,r);try{e[t]=o}catch(n){D&&$.log(`Failed to replace method "${t}" in object`,e)}}function Se(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){D&&$.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Ee(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Se(e,"__sentry_original__",t)}catch(e){}}function ke(e){return e.__sentry_original__}function Pe(e){if(W(e))return{message:e.message,name:e.name,stack:e.stack,...Te(e)};if(ne(e)){const t={type:e.type,target:Oe(e.target),currentTarget:Oe(e.currentTarget),...Te(e)};return"undefined"!=typeof CustomEvent&&oe(e,CustomEvent)&&(t.detail=e.detail),t}return e}function Oe(e){try{return t=e,"undefined"!=typeof Element&&oe(t,Element)?ye(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}var t}function Te(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function Ie(e){return Ce(e,new Map)}function Ce(e,t){if(function(e){if(!te(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const n of Object.getOwnPropertyNames(e))void 0!==e[n]&&(r[n]=Ce(e[n],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(Ce(e,t))})),r}return e}const De="?",Ne=/\(error: (.*)\)/,Le=/captureMessage|captureException/;function Ae(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0,r=0)=>{const o=[],i=e.split("\n");for(let e=n;e<i.length;e++){const n=i[e];if(n.length>1024)continue;const a=Ne.test(n)?n.replace(Ne,"$1"):n;if(!a.match(/\S*Error: /)){for(const e of t){const t=e(a);if(t){o.push(t);break}}if(o.length>=50+r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(je(t).function||"")&&t.pop();t.reverse(),Le.test(je(t).function||"")&&(t.pop(),Le.test(je(t).function||"")&&t.pop());return t.slice(0,50).map((e=>({...e,filename:e.filename||je(t).filename,function:e.function||De})))}(o.slice(r))}}function je(e){return e[e.length-1]||{}}const Re="<anonymous>";function Me(e){try{return e&&"function"==typeof e&&e.name||Re}catch(e){return Re}}function $e(e){const t=e.exception;if(t){const e=[];try{return t.values.forEach((t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)})),e}catch(e){return}}}function Ue(e,t=100,n=1/0){try{return qe("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function Ge(e,t=3,n=102400){const r=Ue(e,t);return o=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(o))>n?Ge(e,t-1,n):r;var o}function qe(e,t,n=1/0,r=1/0,o=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[i,a]=o;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const s=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(ie(t))return"[VueViewModel]";if(te(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${Me(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!s.startsWith("[object "))return s;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return s.replace("object ","");if(i(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return qe("",u.toJSON(),c-1,r,o)}catch(e){}const l=Array.isArray(t)?[]:{};let f=0;const d=Pe(t);for(const e in d){if(!Object.prototype.hasOwnProperty.call(d,e))continue;if(f>=r){l[e]="[MaxProperties ~]";break}const t=d[e];l[e]=qe(e,t,c-1,r,o),f++}return a(t),l}function Fe(e,t=[]){return[e,t]}function He(e,t){const[n,r]=e;return[n,[...r,t]]}function Be(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function Ve(e){return L.__SENTRY__&&L.__SENTRY__.encodePolyfill?L.__SENTRY__.encodePolyfill(e):(new TextEncoder).encode(e)}function ze(e){const[t,n]=e;let r=JSON.stringify(t);function o(e){"string"==typeof r?r="string"==typeof e?r+e:[Ve(r),e]:r.push("string"==typeof e?Ve(e):e)}for(const e of n){const[t,n]=e;if(o(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)o(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(Ue(n))}o(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function Ye(e){const t="string"==typeof e.data?Ve(e.data):e.data;return[Ie({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const We={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function Je(e){return We[e]}function Ke(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}class Xe extends Error{constructor(e,t="warn"){super(e),this.message=e,this.logLevel=t}}function Ze(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return ce(new Xe("Not adding Promise because buffer limit was reached."));const o=r();return-1===t.indexOf(o)&&t.push(o),o.then((()=>n(o))).then(null,(()=>n(o).then(null,(()=>{})))),o},drain:function(e){return new ue(((n,r)=>{let o=t.length;if(!o)return n(!0);const i=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{se(e).then((()=>{--o||(clearTimeout(i),n(!0))}),r)}))}))}}}function Qe(e,{statusCode:t,headers:n},r=Date.now()){const o={...e},i=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(i)for(const e of i.trim().split(",")){const[t,n,,,i]=e.split(":",5),a=parseInt(t,10),s=1e3*(isNaN(a)?60:a);if(n)for(const e of n.split(";"))"metric_bucket"===e&&i&&!i.split(";").includes("custom")||(o[e]=r+s);else o.all=r+s}else a?o.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?6e4:r-t}(a,r):429===t&&(o.all=r+6e4);return o}function et(e,t,n=Ze(e.bufferSize||64)){let r={};return{send:function(o){const i=[];if(Be(o,((t,n)=>{const o=Je(n);if(function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(r,o)){const r=tt(t,n);e.recordDroppedEvent("ratelimit_backoff",o,r)}else i.push(t)})),0===i.length)return se({});const a=Fe(o[0],i),s=t=>{Be(a,((n,r)=>{const o=tt(n,r);e.recordDroppedEvent(t,Je(r),o)}))};return n.add((()=>t({body:ze(a)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&le&&$.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=Qe(r,e),e)),(e=>{throw s("network_error"),e})))).then((e=>e),(e=>{if(e instanceof Xe)return le&&$.error("Skipped sending event because buffer is full."),s("queue_overflow"),se({});throw e}))},flush:e=>n.drain(e)}}function tt(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}const nt=[];function rt(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function ot(e,t,n){if(n[t.name])le&&$.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===nt.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),nt.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}le&&$.log(`Integration installed: ${t.name}`)}}function it(){const e=L,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function at(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function st(e){const{message:t,event_id:n}=e;if(t)return t;const r=at(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function ct(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],i=o[0]=o[0]||{};i.value||(i.value=t||""),i.type||(i.type=n||"Error")}function ut(e,t){const n=at(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function lt(e){if(function(e){try{return e.__sentry_captured__}catch(e){}}(e))return!0;try{Se(e,"__sentry_captured__",!0)}catch(e){}return!1}const ft=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],dt=(e={})=>({name:"InboundFilters",processEvent(t,n,r){const o=r.getOptions(),i=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:ft],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,o);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e))return le&&$.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${st(e)}`),!0;if(function(e,t){if(e.type||!t||!t.length)return!1;return function(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch(e){}n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`));return t}(e).some((e=>_e(e,t)))}(e,t.ignoreErrors))return le&&$.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${st(e)}`),!0;if(function(e){if(e.type)return!1;if(!e.exception||!e.exception.values||0===e.exception.values.length)return!1;return!e.message&&!e.exception.values.some((e=>e.stacktrace||e.type&&"Error"!==e.type||e.value))}(e))return le&&$.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${st(e)}`),!0;if(function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&_e(n,t)}(e,t.ignoreTransactions))return le&&$.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${st(e)}`),!0;if(function(e,t){if(!t||!t.length)return!1;const n=pt(e);return!!n&&_e(n,t)}(e,t.denyUrls))return le&&$.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${st(e)}.\nUrl: ${pt(e)}`),!0;if(!function(e,t){if(!t||!t.length)return!0;const n=pt(e);return!n||_e(n,t)}(e,t.allowUrls))return le&&$.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${st(e)}.\nUrl: ${pt(e)}`),!0;return!1}(t,i)?null:t}});function pt(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return le&&$.error(`Cannot extract url for event ${st(e)}`),null}}function ht(){return vt(L),L}function vt(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||N,t[N]=t[N]||{}}function yt(){return Date.now()/1e3}const bt=function(){const{performance:e}=L;if(!e||!e.now)return yt;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/1e3}();let mt;(()=>{const{performance:e}=L;if(!e||!e.now)return void(mt="none");const t=36e5,n=e.now(),r=Date.now(),o=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,i=o<t,a=e.timing&&e.timing.navigationStart,s="number"==typeof a?Math.abs(a+n-r):t;i||s<t?o<=s?(mt="timeOrigin",e.timeOrigin):mt="navigationStart":mt="dateNow"})();function gt(e){const t=bt(),n={sid:it(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return Ie({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&wt(n,e),n}function wt(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||bt(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:it()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function _t(){return it()}function xt(){return it().substring(16)}function St(e,t,n=2){if(!t||"object"!=typeof t||n<=0)return t;if(e&&t&&0===Object.keys(t).length)return e;const r={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=St(r[e],t[e],n-1));return r}const Et="_sentrySpan";function kt(e,t){t?Se(e,Et,t):delete e[Et]}function Pt(e){return e[Et]}class Ot{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:_t(),spanId:xt()}}clone(){const e=new Ot;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,kt(e,Pt(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&wt(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,[n,r]=t instanceof Tt?[t.getScopeData(),t.getRequestSession()]:te(t)?[e,e.requestSession]:[],{tags:o,extra:i,user:a,contexts:s,level:c,fingerprint:u=[],propagationContext:l}=n||{};return this._tags={...this._tags,...o},this._extra={...this._extra,...i},this._contexts={...this._contexts,...s},a&&Object.keys(a).length&&(this._user=a),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),r&&(this._requestSession=r),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,kt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:_t()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:yt(),...e};return this._breadcrumbs.push(r),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Pt(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=St(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:xt(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:it();if(!this._client)return $.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n&&n.event_id?n.event_id:it();if(!this._client)return $.warn("No client configured on scope - will not capture message!"),r;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r},this),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:it();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):($.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}const Tt=Ot;class It{constructor(e,t){let n,r;n=e||new Tt,r=t||new Tt,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return re(n)?n.then((e=>(this._popScope(),e)),(e=>{throw this._popScope(),e})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Ct(){const e=vt(ht());return e.stack=e.stack||new It(A("defaultCurrentScope",(()=>new Tt)),A("defaultIsolationScope",(()=>new Tt)))}function Dt(e){return Ct().withScope(e)}function Nt(e,t){const n=Ct();return n.withScope((()=>(n.getStackTop().scope=e,t(e))))}function Lt(e){return Ct().withScope((()=>e(Ct().getIsolationScope())))}function At(e){const t=vt(e);return t.acs?t.acs:{withIsolationScope:Lt,withScope:Dt,withSetScope:Nt,withSetIsolationScope:(e,t)=>Lt(t),getCurrentScope:()=>Ct().getScope(),getIsolationScope:()=>Ct().getIsolationScope()}}function jt(){return At(ht()).getCurrentScope()}function Rt(){return At(ht()).getIsolationScope()}function Mt(){return jt().getClient()}function $t(e){const t=e.getPropagationContext(),{traceId:n,spanId:r,parentSpanId:o}=t;return Ie({trace_id:n,span_id:r,parent_span_id:o})}let Ut;const Gt=new WeakMap,qt=()=>({name:"FunctionToString",setupOnce(){Ut=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=ke(this),n=Gt.has(Mt())&&void 0!==t?t:this;return Ut.apply(n,e)}}catch(e){}},setup(e){Gt.set(e,!0)}}),Ft=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!Bt(e,t))return!1;if(!Ht(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=Vt(t),r=Vt(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!Bt(e,t))return!1;if(!Ht(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return le&&$.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}};function Ht(e,t){let n=$e(e),r=$e(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function Bt(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function Vt(e){return e.exception&&e.exception.values&&e.exception.values[0]}const zt={},Yt={};function Wt(e,t){zt[e]=zt[e]||[],zt[e].push(t)}function Jt(e,t){if(!Yt[e]){Yt[e]=!0;try{t()}catch(t){D&&$.error(`Error while instrumenting ${e}`,t)}}}function Kt(e,t){const n=e&&zt[e];if(n)for(const r of n)try{r(t)}catch(t){D&&$.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Me(r)}\nError:`,t)}}let Xt,Zt,Qt;function en(){if(!H.document)return;const e=Kt.bind(null,"dom"),t=tn(e,!0);H.document.addEventListener("click",t,!1),H.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=H[t],r=n&&n.prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(xe(r,"addEventListener",(function(t){return function(n,r,o){if("click"===n||"keypress"==n)try{const r=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},i=r[n]=r[n]||{refCount:0};if(!i.handler){const r=tn(e);i.handler=r,t.call(this,n,r,o)}i.refCount++}catch(e){}return t.call(this,n,r,o)}})),xe(r,"removeEventListener",(function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this.__sentry_instrumentation_handlers__||{},o=n[t];o&&(o.refCount--,o.refCount<=0&&(e.call(this,t,o.handler,r),o.handler=void 0,delete n[t]),0===Object.keys(n).length&&delete this.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,r)}})))}))}function tn(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch(e){return null}}(n);if(function(e,t){return"keypress"===e&&(!t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;Se(n,"_sentryCaptured",!0),r&&!r._sentryId&&Se(r,"_sentryId",it());const o="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==Zt)return!1;try{if(!e.target||e.target._sentryId!==Qt)return!1}catch(e){}return!0}(n)){e({event:n,name:o,global:t}),Zt=n.type,Qt=r?r._sentryId:void 0}clearTimeout(Xt),Xt=H.setTimeout((()=>{Qt=void 0,Zt=void 0}),1e3)}}const nn="__sentry_xhr_v3__";function rn(){if(!H.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,n){const r=new Error,o=1e3*bt(),i=Z(n[0])?n[0].toUpperCase():void 0,a=function(e){if(Z(e))return e;try{return e.toString()}catch(e){}return}(n[1]);if(!i||!a)return e.apply(t,n);t[nn]={method:i,url:a,request_headers:{}},"POST"===i&&a.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const s=()=>{const e=t[nn];if(e&&4===t.readyState){try{e.status_code=t.status}catch(e){}Kt("xhr",{endTimestamp:1e3*bt(),startTimestamp:o,xhr:t,virtualError:r})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply(e,t,n){return s(),e.apply(t,n)}}):t.addEventListener("readystatechange",s),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,n){const[r,o]=n,i=t[nn];return i&&Z(r)&&Z(o)&&(i.request_headers[r.toLowerCase()]=o),e.apply(t,n)}}),e.apply(t,n)}}),e.send=new Proxy(e.send,{apply(e,t,n){const r=t[nn];if(!r)return e.apply(t,n);void 0!==n[0]&&(r.body=n[0]);return Kt("xhr",{startTimestamp:1e3*bt(),xhr:t}),e.apply(t,n)}})}const on=L;let an;function sn(e){const t="history";Wt(t,e),Jt(t,cn)}function cn(){if(!function(){const e=on.chrome,t=e&&e.app&&e.app.runtime,n="history"in on&&!!on.history.pushState&&!!on.history.replaceState;return!t&&n}())return;const e=H.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=an,t=String(n);an=t;Kt("history",{from:e,to:t})}return e.apply(this,t)}}H.onpopstate=function(...t){const n=H.location.href,r=an;an=n;if(Kt("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(e){}},xe(H.history,"pushState",t),xe(H.history,"replaceState",t)}function un(){"console"in L&&j.forEach((function(e){e in L.console&&xe(L.console,e,(function(t){return R[e]=t,function(...t){Kt("console",{args:t,level:e});const n=R[e];n&&n.apply(L.console,t)}}))}))}function ln(e,t=!1){t&&!function(){if("string"==typeof EdgeRuntime)return!0;if(!G())return!1;if(q(U.fetch))return!0;let e=!1;const t=U.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=q(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){D&&$.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}()||xe(L,"fetch",(function(t){return function(...n){const r=new Error,{method:o,url:i}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:dn(t),method:fn(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:dn(t),method:fn(t,"method")?String(t.method).toUpperCase():"GET"}}(n),a={args:n,fetchData:{method:o,url:i},startTimestamp:1e3*bt(),virtualError:r};return e||Kt("fetch",{...a}),t.apply(L,n).then((async t=>(e?e(t):Kt("fetch",{...a,endTimestamp:1e3*bt(),response:t}),t)),(e=>{throw Kt("fetch",{...a,endTimestamp:1e3*bt(),error:e}),W(e)&&void 0===e.stack&&(e.stack=r.stack,Se(e,"framesToPop",1)),e}))}}))}function fn(e,t){return!!e&&"object"==typeof e&&!!e[t]}function dn(e){return"string"==typeof e?e:e?fn(e,"url")?e.url:e.toString?e.toString():"":""}const pn=100;function hn(e,t){const n=Mt(),r=Rt();if(!n)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:i=pn}=n.getOptions();if(i<=0)return;const a={timestamp:yt(),...e},s=o?M((()=>o(a,t))):a;null!==s&&(n.emit&&n.emit("beforeAddBreadcrumb",s,t),r.addBreadcrumb(s,i))}function vn(e){return"warn"===e?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}function yn(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}function bn(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}const mn="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,gn="production";function wn(e,t,n,r=0){return new ue(((o,i)=>{const a=e[r];if(null===t||"function"!=typeof a)o(t);else{const s=a({...t},n);le&&a.id&&null===s&&$.log(`Event processor "${a.id}" dropped event`),re(s)?s.then((t=>wn(e,t,n,r+1).then(o))).then(null,i):wn(e,s,n,r+1).then(o).then(null,i)}}))}let _n,xn,Sn;function En(e){const t=L._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return Sn&&n.length===xn||(xn=n.length,Sn=n.reduce(((n,r)=>{_n||(_n={});const o=_n[r];if(o)n[o[0]]=o[1];else{const o=e(r);for(let e=o.length-1;e>=0;e--){const i=o[e],a=i&&i.filename,s=t[r];if(a&&s){n[a]=s,_n[r]=[a,s];break}}}return n}),{})),Sn}const kn=/^sentry-/;function Pn(e){const t=function(e){if(!e||!Z(e)&&!Array.isArray(e))return;if(Array.isArray(e))return e.reduce(((e,t)=>{const n=On(t);return Object.entries(n).forEach((([t,n])=>{e[t]=n})),e}),{});return On(e)}(e);if(!t)return;const n=Object.entries(t).reduce(((e,[t,n])=>{if(t.match(kn)){e[t.slice(7)]=n}return e}),{});return Object.keys(n).length>0?n:void 0}function On(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(t&&n&&(e[t]=n),e)),{})}const Tn="_sentryMetrics";function In(e){const t=e[Tn];if(!t)return;const n={};for(const[,[e,r]]of t){(n[e]||(n[e]=[])).push(Ie(r))}return n}let Cn=!1;function Dn(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext();return Ie({parent_span_id:r?t:An(e).parent_span_id,span_id:r?xt():t,trace_id:n})}function Nn(e){return"number"==typeof e?Ln(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Ln(e.getTime()):bt()}function Ln(e){return e>9999999999?e/1e3:e}function An(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();try{const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:r,startTime:o,name:i,endTime:a,parentSpanId:s,status:c}=e;return Ie({span_id:t,trace_id:n,data:r,description:i,parent_span_id:s,start_timestamp:Nn(o),timestamp:Nn(a)||void 0,status:Rn(c),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:In(e)})}return{span_id:t,trace_id:n}}catch(e){return{}}}function jn(e){const{traceFlags:t}=e.spanContext();return 1===t}function Rn(e){if(e&&0!==e.code)return 1===e.code?"ok":e.message||"unknown_error"}const Mn="_sentryRootSpan";function $n(e){return e[Mn]||e}function Un(){Cn||(M((()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")})),Cn=!0)}const Gn="_frozenDsc";function qn(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},o=Ie({environment:n.environment||gn,release:n.release,public_key:r,trace_id:e});return t.emit("createDsc",o),o}function Fn(e){const t=Mt();if(!t)return{};const n=$n(e),r=n[Gn];if(r)return r;const o=n.spanContext().traceState,i=o&&o.get("sentry.dsc"),a=i&&Pn(i);if(a)return a;const s=qn(e.spanContext().traceId,t),c=An(n),u=c.data||{},l=u["sentry.sample_rate"];null!=l&&(s.sample_rate=`${l}`);const f=u["sentry.source"],d=c.description;return"url"!==f&&d&&(s.transaction=d),function(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=Mt(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}()&&(s.sampled=String(jn(n))),t.emit("createDsc",s,n),s}function Hn(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:i}=t;!function(e,t){const{extra:n,tags:r,user:o,contexts:i,level:a,transactionName:s}=t,c=Ie(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const u=Ie(r);u&&Object.keys(u).length&&(e.tags={...u,...e.tags});const l=Ie(o);l&&Object.keys(l).length&&(e.user={...l,...e.user});const f=Ie(i);f&&Object.keys(f).length&&(e.contexts={...f,...e.contexts});a&&(e.level=a);s&&"transaction"!==e.type&&(e.transaction=s)}(e,t),r&&function(e,t){e.contexts={trace:Dn(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:Fn(t),...e.sdkProcessingMetadata};const n=$n(t),r=An(n).description;r&&!e.transaction&&"transaction"===e.type&&(e.transaction=r)}(e,r),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,o),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,i)}function Bn(e,t){const{extra:n,tags:r,user:o,contexts:i,level:a,sdkProcessingMetadata:s,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:f,propagationContext:d,transactionName:p,span:h}=t;Vn(e,"extra",n),Vn(e,"tags",r),Vn(e,"user",o),Vn(e,"contexts",i),e.sdkProcessingMetadata=St(e.sdkProcessingMetadata,s,2),a&&(e.level=a),p&&(e.transactionName=p),h&&(e.span=h),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),f.length&&(e.attachments=[...e.attachments,...f]),e.propagationContext={...e.propagationContext,...d}}function Vn(e,t,n){e[t]=St(e[t],n,1)}function zn(e,t,n,r,o,i){const{normalizeDepth:a=3,normalizeMaxBreadth:s=1e3}=e,c={...t,event_id:t.event_id||n.event_id||it(),timestamp:t.timestamp||yt()},u=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:o,maxValueLength:i=250}=t;e.environment=e.environment||n||gn,!e.release&&r&&(e.release=r);!e.dist&&o&&(e.dist=o);e.message&&(e.message=me(e.message,i));const a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=me(a.value,i));const s=e.request;s&&s.url&&(s.url=me(s.url,i))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,u),o&&o.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){const n=En(t);try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{n&&e.filename&&(e.debug_id=n[e.filename])}))}))}catch(e){}}(c,e.stackParser);const l=function(e,t){if(!t)return e;const n=e?e.clone():new Tt;return n.update(t),n}(r,n.captureContext);n.mechanism&&ut(c,n.mechanism);const f=o?o.getEventProcessors():[],d=A("globalScope",(()=>new Tt)).getScopeData();if(i){Bn(d,i.getScopeData())}if(l){Bn(d,l.getScopeData())}const p=[...n.attachments||[],...d.attachments];p.length&&(n.attachments=p),Hn(c,d);return wn([...f,...d.eventProcessors],c,n).then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach((([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})}))}(e),"number"==typeof a&&a>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:Ue(e.data,t,n)}})))},...e.user&&{user:Ue(e.user,t,n)},...e.contexts&&{contexts:Ue(e.contexts,t,n)},...e.extra&&{extra:Ue(e.extra,t,n)}};e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=Ue(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map((e=>({...e,...e.data&&{data:Ue(e.data,t,n)}}))));e.contexts&&e.contexts.flags&&r.contexts&&(r.contexts.flags=Ue(e.contexts.flags,3,n));return r}(e,a,s):e)))}function Yn(e){if(e)return function(e){return e instanceof Tt||"function"==typeof e}(e)||function(e){return Object.keys(e).some((e=>Wn.includes(e)))}(e)?{captureContext:e}:e}const Wn=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Jn(e,t){return jt().captureEvent(e,t)}function Kn(e){const t=Mt(),n=Rt(),r=jt(),{release:o,environment:i=gn}=t&&t.getOptions()||{},{userAgent:a}=L.navigator||{},s=gt({release:o,environment:i,user:r.getUser()||n.getUser(),...a&&{userAgent:a},...e}),c=n.getSession();return c&&"ok"===c.status&&wt(c,{status:"exited"}),Xn(),n.setSession(s),r.setSession(s),s}function Xn(){const e=Rt(),t=jt(),n=t.getSession()||e.getSession();n&&function(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),wt(e,n)}(n),Zn(),e.setSession(),t.setSession()}function Zn(){const e=Rt(),t=jt(),n=Mt(),r=t.getSession()||e.getSession();r&&n&&n.captureSession(r)}function Qn(e=!1){e?Xn():Zn()}const er=L;let tr=0;function nr(){return tr>0}function rr(e,t={}){if(!function(e){return"function"==typeof e}(e))return e;try{const t=e.__sentry_wrapped__;if(t)return"function"==typeof t?t:e;if(ke(e))return e}catch(t){return e}const n=function(...n){try{const r=n.map((e=>rr(e,t)));return e.apply(this,r)}catch(e){throw tr++,setTimeout((()=>{tr--})),function(...e){const t=At(ht());if(2===e.length){const[n,r]=e;return n?t.withSetScope(n,r):t.withScope(r)}t.withScope(e[0])}((r=>{var o,i;r.addEventProcessor((e=>(t.mechanism&&(ct(e,void 0,void 0),ut(e,t.mechanism)),e.extra={...e.extra,arguments:n},e))),o=e,jt().captureException(o,Yn(i))})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}catch(e){}Ee(n,e),Se(e,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get(){return e.name}})}catch(e){}return n}const or=1024,ir=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:"Breadcrumbs",setup(e){var n;t.console&&function(e){const t="console";Wt(t,e),Jt(t,un)}(function(e){return function(t){if(Mt()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:vn(t.level),message:ge(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${ge(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}hn(n,{input:t.args,level:t.level})}}(e)),t.dom&&(n=function(e,t){return function(n){if(Mt()!==e)return;let r,o,i="object"==typeof t?t.serializeAttribute:void 0,a="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;a&&a>or&&(mn&&$.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${a} was configured. Sentry will use 1024 instead.`),a=or),"string"==typeof i&&(i=[i]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=ye(t,{keyAttrs:i,maxStringLength:a}),o=function(e){if(!ve.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}(t)}catch(e){r="<unknown>"}if(0===r.length)return;const s={category:`ui.${n.name}`,message:r};o&&(s.data={"ui.component_name":o}),hn(s,{event:n.event,name:n.name,global:n.global})}}(e,t.dom),Wt("dom",n),Jt("dom",en)),t.xhr&&function(e){Wt("xhr",e),Jt("xhr",rn)}(function(e){return function(t){if(Mt()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,o=t.xhr[nn];if(!n||!r||!o)return;const{method:i,url:a,status_code:s,body:c}=o,u={method:i,url:a,status_code:s},l={xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r};hn({category:"xhr",data:u,type:"http",level:yn(s)},l)}}(e)),t.fetch&&function(e,t){const n="fetch";Wt(n,e),Jt(n,(()=>ln(void 0,t)))}(function(e){return function(t){if(Mt()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){hn({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:n,endTimestamp:r})}else{const e=t.response,o={...t.fetchData,status_code:e&&e.status},i={input:t.args,response:e,startTimestamp:n,endTimestamp:r};hn({category:"fetch",data:o,type:"http",level:yn(o.status_code)},i)}}}(e)),t.history&&sn(function(e){return function(t){if(Mt()!==e)return;let n=t.from,r=t.to;const o=bn(er.location.href);let i=n?bn(n):void 0;const a=bn(r);i&&i.path||(i=o),o.protocol===a.protocol&&o.host===a.host&&(r=a.relative),o.protocol===i.protocol&&o.host===i.host&&(n=i.relative),hn({category:"navigation",data:{from:n,to:r}})}}(e)),t.sentry&&e.on("beforeSendEvent",function(e){return function(t){Mt()===e&&hn({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:st(t)},{event:t})}}(e))}}};const ar=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],sr=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:"BrowserApiErrors",setupOnce(){t.setTimeout&&xe(er,"setTimeout",cr),t.setInterval&&xe(er,"setInterval",cr),t.requestAnimationFrame&&xe(er,"requestAnimationFrame",ur),t.XMLHttpRequest&&"XMLHttpRequest"in er&&xe(XMLHttpRequest.prototype,"send",lr);const e=t.eventTarget;if(e){(Array.isArray(e)?e:ar).forEach(fr)}}}};function cr(e){return function(...t){const n=t[0];return t[0]=rr(n,{mechanism:{data:{function:Me(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function ur(e){return function(t){return e.apply(this,[rr(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Me(e)},handled:!1,type:"instrument"}})])}}function lr(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&xe(n,e,(function(t){const n={mechanism:{data:{function:e,handler:Me(t)},handled:!1,type:"instrument"}},r=ke(t);return r&&(n.mechanism.data.handler=Me(r)),rr(t,n)}))})),e.apply(this,t)}}function fr(e){const t=er[e],n=t&&t.prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(xe(n,"addEventListener",(function(t){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=rr(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Me(r),target:e},handled:!1,type:"instrument"}}))}catch(e){}return t.apply(this,[n,rr(r,{mechanism:{data:{function:"addEventListener",handler:Me(r),target:e},handled:!1,type:"instrument"}}),o])}})),xe(n,"removeEventListener",(function(e){return function(t,n,r){try{const o=n.__sentry_wrapped__;o&&e.call(this,t,o,r)}catch(e){}return e.call(this,t,n,r)}})))}const dr=()=>({name:"BrowserSession",setupOnce(){void 0!==er.document?(Kn({ignoreDuration:!0}),Qn(),sn((({from:e,to:t})=>{void 0!==e&&e!==t&&(Kn({ignoreDuration:!0}),Qn())}))):mn&&$.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}});let pr=null;function hr(){pr=L.onerror,L.onerror=function(e,t,n,r,o){return Kt("error",{column:r,error:o,line:n,msg:e,url:t}),!!pr&&pr.apply(this,arguments)},L.onerror.__SENTRY_INSTRUMENTED__=!0}let vr=null;function yr(){vr=L.onunhandledrejection,L.onunhandledrejection=function(e){return Kt("unhandledrejection",e),!vr||vr.apply(this,arguments)},L.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function br(e,t){const n=wr(e,t),r={type:Sr(t),value:Er(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function mr(e,t,n,r){const o=Mt(),i=o&&o.getOptions().normalizeDepth,a=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}return}(t),s={__serialized__:Ge(t,i)};if(a)return{exception:{values:[br(e,a)]},extra:s};const c={exception:{values:[{type:ne(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:Or(t,{isUnhandledRejection:r})}]},extra:s};if(n){const t=wr(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}function gr(e,t){return{exception:{values:[br(e,t)]}}}function wr(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e&&_r.test(e.message))return 1;return 0}(t),o=function(e){if("number"==typeof e.framesToPop)return e.framesToPop;return 0}(t);try{return e(n,r,o)}catch(e){}return[]}const _r=/Minified React error #\d+;/i;function xr(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Sr(e){const t=e&&e.name;if(!t&&xr(e)){return e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception"}return t}function Er(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:xr(e)&&Array.isArray(e.message)&&2==e.message.length?e.message[1]:t:"No error message"}function kr(e,t,n,r,o){let i;if(K(t)&&t.error){return gr(e,t.error)}if(X(t)||J(t,"DOMException")){const o=t;if("stack"in t)i=gr(e,t);else{const t=o.name||(X(o)?"DOMError":"DOMException"),a=o.message?`${t}: ${o.message}`:t;i=Pr(e,a,n,r),ct(i,a)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}if(W(t))return gr(e,t);if(te(t)||ne(t)){return i=mr(e,t,n,o),ut(i,{synthetic:!0}),i}return i=Pr(e,t,n,r),ct(i,`${t}`,void 0),ut(i,{synthetic:!0}),i}function Pr(e,t,n,r){const o={};if(r&&n){const r=wr(e,n);r.length&&(o.exception={values:[{value:t,stacktrace:{frames:r}}]}),ut(o,{synthetic:!0})}if(Q(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}function Or(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(Pe(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return me(r,t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:me(r,t)}return""}(e),r=t?"promise rejection":"exception";if(K(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(ne(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}const Tr=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(!function(e){!function(e){const t="error";Wt(t,e),Jt(t,hr)}((t=>{const{stackParser:n,attachStacktrace:r}=Cr();if(Mt()!==e||nr())return;const{msg:o,url:i,line:a,column:s,error:c}=t,u=function(e,t,n,r){const o=e.exception=e.exception||{},i=o.values=o.values||[],a=i[0]=i[0]||{},s=a.stacktrace=a.stacktrace||{},c=s.frames=s.frames||[],u=r,l=n,f=Z(t)&&t.length>0?t:function(){try{return ve.document.location.href}catch(e){return""}}();0===c.length&&c.push({colno:u,filename:f,function:De,in_app:!0,lineno:l});return e}(kr(n,c||o,void 0,r,!1),i,a,s);u.level="error",Jn(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})}))}(e),Ir("onerror")),t.onunhandledrejection&&(!function(e){!function(e){const t="unhandledrejection";Wt(t,e),Jt(t,yr)}((t=>{const{stackParser:n,attachStacktrace:r}=Cr();if(Mt()!==e||nr())return;const o=function(e){if(ee(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch(e){}return e}(t),i=ee(o)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(o)}`}]}}:kr(n,o,void 0,r,!0);i.level="error",Jn(i,{originalException:o,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}(e),Ir("onunhandledrejection"))}}};function Ir(e){mn&&$.log(`Global Handler attached: ${e}`)}function Cr(){const e=Mt();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Dr=()=>({name:"HttpContext",preprocessEvent(e){if(!er.navigator&&!er.location&&!er.document)return;const t=e.request&&e.request.url||er.location&&er.location.href,{referrer:n}=er.document||{},{userAgent:r}=er.navigator||{},o={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},i={...e.request,...t&&{url:t},headers:o};e.request=i}});function Nr(e,t,n=250,r,o,i,a){if(!(i.exception&&i.exception.values&&a&&oe(a.originalException,Error)))return;const s=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;var c,u;s&&(i.exception.values=(c=Lr(e,t,o,a.originalException,r,i.exception.values,s,0),u=n,c.map((e=>(e.value&&(e.value=me(e.value,u)),e)))))}function Lr(e,t,n,r,o,i,a,s){if(i.length>=n+1)return i;let c=[...i];if(oe(r[o],Error)){Ar(a,s);const i=e(t,r[o]),u=c.length;jr(i,o,u,s),c=Lr(e,t,n,r[o],o,[i,...c],i,u)}return Array.isArray(r.errors)&&r.errors.forEach(((r,i)=>{if(oe(r,Error)){Ar(a,s);const u=e(t,r),l=c.length;jr(u,`errors[${i}]`,l,s),c=Lr(e,t,n,r,o,[u,...c],u,l)}})),c}function Ar(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function jr(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}const Rr=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,o){const i=o.getOptions();Nr(br,i.stackParser,i.maxValueLength,n,t,e,r)}}};function Mr(e){const t=[dt(),qt(),sr(),ir(),Tr(),Rr(),Ft(),Dr()];return!1!==e.autoSessionTracking&&t.push(dr()),t}function $r(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function Ur(e,t,n){return t||`${function(e){return`${$r(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){const n={sentry_version:"7"};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}(e,n)}`}function Gr(e,t,n,r){const o=Ke(n),i=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const a=function(e,t,n,r){const o=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:de(r)},...o&&{trace:Ie({...o})}}}(e,o,r,t);delete e.sdkProcessingMetadata;return Fe(a,[[{type:i},e]])}const qr="Not capturing exception because it's already been captured.";class Fr{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=he(e.dsn):le&&$.warn("No DSN provided, client will not send events."),this._dsn){const t=Ur(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find((t=>t in e&&null==e[t]));t&&M((()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)}))}captureException(e,t,n){const r=it();if(lt(e))return le&&$.log(qr),r;const o={event_id:r,...t};return this._process(this.eventFromException(e,o).then((e=>this._captureEvent(e,o,n)))),o.event_id}captureMessage(e,t,n,r){const o={event_id:it(),...n},i=Q(e)?e:String(e),a=ee(e)?this.eventFromMessage(i,t,o):this.eventFromException(e,o);return this._process(a.then((e=>this._captureEvent(e,o,r)))),o.event_id}captureEvent(e,t,n){const r=it();if(t&&t.originalException&&lt(t.originalException))return le&&$.log(qr),r;const o={event_id:r,...t},i=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,o,i||n)),o.event_id}captureSession(e){"string"!=typeof e.release?le&&$.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),wt(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):se(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.emit("close"),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];ot(this,e,this._integrations),t||rt(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=Gr(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=He(n,Ye(e));const r=this.sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,r){const o=Ke(n);return Fe({sent_at:(new Date).toISOString(),...o&&{sdk:o},...!!r&&t&&{dsn:de(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const r="number"==typeof n?n:1,o=`${e}:${t}`;le&&$.log(`Recording outcome: "${o}"${r>1?` (${r} times)`:""}`),this._outcomes[o]=(this._outcomes[o]||0)+r}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach((e=>e(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(e=>(le&&$.error("Error while sending envelope:",e),e))):(le&&$.error("Transport disabled"),se({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&ot(e,t,n)})),n}(this,e),rt(this,e)}_updateSessionFromEvent(e,t){let n="fatal"===t.level,r=!1;const o=t.exception&&t.exception.values;if(o){r=!0;for(const e of o){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const i="ok"===e.status;(i&&0===e.errors||i&&n)&&(wt(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ue((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n=jt(),r=Rt()){const o=this.getOptions(),i=Object.keys(this._integrations);return!t.integrations&&i.length>0&&(t.integrations=i),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),zn(o,e,t,n,this,r).then((e=>{if(null===e)return e;e.contexts={trace:$t(n),...e.contexts};const t=function(e,t){const n=t.getPropagationContext();return n.dsc||qn(n.traceId,e)}(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:t,...e.sdkProcessingMetadata},e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{le&&(e instanceof Xe&&"log"===e.logLevel?$.log(e.message):$.warn(e))}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:o}=r,i=Br(e),a=Hr(e),s=e.type||"error",c=`before send for type \`${s}\``,u=void 0===o?void 0:function(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;if(!("number"!=typeof t||isNaN(t)||t<0||t>1))return t;le&&$.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`)}(o);if(a&&"number"==typeof u&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error",e),ce(new Xe(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const l="replay_event"===s?"replay":s,f=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,f).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new Xe("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const o=function(e,t,n,r){const{beforeSend:o,beforeSendTransaction:i,beforeSendSpan:a}=t;if(Hr(n)&&o)return o(n,r);if(Br(n)){if(n.spans&&a){const t=[];for(const r of n.spans){const n=a(r);n?t.push(n):(Un(),e.recordDroppedEvent("before_send","span"))}n.spans=t}if(i){if(n.spans){const e=n.spans.length;n.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return i(n,r)}}return n}(this,r,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(re(e))return e.then((e=>{if(!te(e)&&null!==e)throw new Xe(n);return e}),(e=>{throw new Xe(`${t} rejected with ${e}`)}));if(!te(e)&&null!==e)throw new Xe(n);return e}(o,c)})).then((r=>{if(null===r){if(this.recordDroppedEvent("before_send",l,e),i){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw new Xe(`${c} returned \`null\`, will not send event.`,"log")}const o=n&&n.getSession();if(!i&&o&&this._updateSessionFromEvent(o,r),i){const e=(r.sdkProcessingMetadata&&r.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(r.spans?r.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const a=r.transaction_info;if(i&&a&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...a,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof Xe)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new Xe(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([e,t])=>{const[n,r]=e.split(":");return{reason:n,category:r,quantity:t}}))}_flushOutcomes(){le&&$.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(le&&$.log("No outcomes to send"));if(!this._dsn)return void(le&&$.log("No dsn provided, will not send outcomes"));le&&$.log("Sending outcomes:",e);const t=(n=e,Fe((r=this._options.tunnel&&de(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:o||yt(),discarded_events:n}]]));var n,r,o;this.sendEnvelope(t)}}function Hr(e){return void 0===e.type}function Br(e){return"transaction"===e.type}class Vr extends Fr{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};!function(e,t,n=[t],r="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map((e=>({name:`${r}:@sentry/${e}`,version:N}))),version:N}),e._metadata=o}(t,"browser",["browser"],er.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&er.document&&er.document.addEventListener("visibilitychange",(()=>{"hidden"===er.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return function(e,t,n,r){const o=kr(e,t,n&&n.syntheticException||void 0,r);return ut(o),o.level="error",n&&n.event_id&&(o.event_id=n.event_id),se(o)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,o){const i=Pr(e,t,r&&r.syntheticException||void 0,o);return i.level=n,r&&r.event_id&&(i.event_id=r.event_id),se(i)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(mn&&$.warn("SDK not enabled, will not capture user feedback."));const t=function(e,{metadata:t,tunnel:n,dsn:r}){const o={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:de(r)}},i=function(e){return[{type:"user_report"},e]}(e);return Fe(o,[i])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}}function zr(e,t,n,r){const o={filename:e,function:"<anonymous>"===t?De:t,in_app:!0};return void 0!==n&&(o.lineno=n),void 0!==r&&(o.colno=r),o}const Yr=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Wr=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Jr=/\((\S*)(?::(\d+))(?::(\d+))\)/,Kr=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Xr=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Zr=Ae(...[[30,e=>{const t=Yr.exec(e);if(t){const[,e,n,r]=t;return zr(e,De,+n,+r)}const n=Wr.exec(e);if(n){if(n[2]&&0===n[2].indexOf("eval")){const e=Jr.exec(n[2]);e&&(n[2]=e[1],n[3]=e[2],n[4]=e[3])}const[e,t]=Qr(n[1]||De,n[2]);return zr(t,e,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,e=>{const t=Kr.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=Xr.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||De;return[n,e]=Qr(n,e),zr(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]]),Qr=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:De,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};var eo=n(430),to=function(e,t){Object.keys(e).forEach((function(n){t(n,e[n])}))},no=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ro=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},oo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},io=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ao={},so={},co=function(e,t,n,r,o){var i,a;void 0===r&&(r=[]),void 0===o&&(o=[]);var s=n.join("${}"),c=null===(a=null===(i=ao.contexts)||void 0===i?void 0:i[e])||void 0===a?void 0:a[s];if(c){var u=c.key,l=c.value,f=so[u]||(so[u]=function(e){var t=[];return e.replace(/\$\{[^}]+}/g,(function(e){return t.push(e.substring(2,e.length-1).trim()),""})),t}(u)),d=t(l);if(d)return d.replace(/\$\{[^}]+}/g,(function(e){var t=f.indexOf(e.substring(2,e.length-1).trim());return void 0!==r[t]?r[t]:""}))}return t&&t(io([void 0],oo(o),!1))||n.reduce((function(e,t,n){return e+t+(void 0!==r[n]?r[n]:"")}),"")},uo=function(e,t){Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:t})},lo=void 0,fo=function(){function e(e){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:e})}return Object.defineProperty(e.prototype,"t",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return co(this.context,(function(e){return oo(e,1)[0]}),e,t)}}),Object.defineProperty(e.prototype,"plural",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return co(this.context,(function(t){return lo?lo(e,t):t[1===Math.abs(e)?0:1]}),t.template,t.args,n)}}),e}(),po=function(e){return new fo(e)},ho={},vo=/\splural ?=?([\s\S]*);?/,yo=function(e,t){var n={};to(t.contexts||{},(function(e,t){var r={};to(t,(function(e,t){r[e.replace(/\$\{[^}]+}/g,"${}")]={key:e,value:t}})),n[e]=r})),ao={headers:t.headers||{},contexts:n};var r,o=t.headers;lo=(0,eo.getPluralFunc)((null==o?void 0:o.language)||e)||(r=function(e){var t,n=(null==e?void 0:e["plural-forms"])||"nplurals=2; plural=(n != 1);",r=null===(t=vo.exec(n))||void 0===t?void 0:t[1];return r&&";"===r[r.length-1]&&(r=r.slice(0,-1)),r||"plural=(n != 1)"}(o),ho[r]||(ho[r]=new Function("n","args",function(e){return"return args[+ (".concat(e,")];")}(r))))},bo=function(e){return no(void 0,void 0,void 0,(function(){var t,n;return ro(this,(function(r){switch(r.label){case 0:switch(e){case"es_419":case"es_AR":case"es_CL":case"es_DO":case"es_MX":e="es_LA"}return t=yo,n=[e],[4,fetch("/locales/"+e+".json")];case 1:return[4,r.sent().json()];case 2:return t.apply(void 0,n.concat([r.sent()])),[2]}}))}))},mo=function(){return navigator.language||navigator.userLanguage},go=function(e){return{be:"be_BY",ca:"ca_ES",cs:"cs_CZ",el:"el_GR",en:"en_US",hi:"hi_IN",ja:"ja_JP",ka:"ka_GE",ko:"ko_KR",nb:"nb_NO",nn:"nb_NO",no:"nb_NO",pt:"pt_BR",sl:"sl_SI",sv:"sv_SE",uk:"uk_UA",vi:"vi_VN"}[e]||e+"_"+e.toUpperCase()},wo=function(){var e=mo();if("string"!=typeof e||!e)return"en_US";var t=e.replace("-","_");return-1!==t.indexOf("_")?t:go(t)},_o=function(e){return Object.keys(e)},xo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},So=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Eo=[],ko=function(e,t){var n,r,o=void 0;(n={})[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.apply(void 0,So([],xo(e),!1)),null==o||o()},r=n,Eo.push(r),o=function(){Eo.splice(Eo.indexOf(r),1)}};chrome.runtime.onMessage.addListener((function(e){return Eo.forEach((function(t){var n=e.type,r=n?t[n]:void 0;"function"!=typeof r?t.error&&e.error&&t.error(e.error):r(e.data)})),!1}));var Po=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Oo=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},To=n.g||window;To.browser||(To.browser=chrome);var Io,Co,Do,No,Lo,Ao=function(e,t){return void 0===t&&(t=void 0),new Promise((function(n,r){return Po(void 0,void 0,void 0,(function(){var o,i,a,s;return Oo(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),o=function(e){var t;if(e){var o=null==e?void 0:e.result,i=null==o?void 0:o.error;if(!i||i.Warning){var a=null===(t=null===browser||void 0===browser?void 0:browser.runtime)||void 0===t?void 0:t.lastError;a?r(a.message?new Error(a.message):a):n(o)}else r(i)}},i=function(){try{var n=Date.now()+":"+Math.random(),r=browser.runtime.sendMessage(browser.runtime.id,{type:e,data:t,respondTo:"broadcast",requestId:n},void 0,o);return ko("answer:"+n,o),r}catch(n){return browser.runtime.sendMessage(browser.runtime.id,{type:e,data:t,respondTo:"promise"})}}(),i instanceof Promise?(a=o,[4,i]):[3,2];case 1:a.apply(void 0,[c.sent()]),c.label=2;case 2:return[3,4];case 3:return s=c.sent(),r(s),[3,4];case 4:return[2]}}))}))}))},jo=function(e,t){return void 0===t&&(t=void 0),Ao(e,t)};!function(e){e.SIGN_OUT="signOut",e.SWITCH_ACCOUNT="switchAccount",e.DISCONNECT="disconnect",e.CONNECT="connect",e.CONNECTING="connecting"}(Io||(Io={})),function(e){e.BYPASS_LIST="bypassList"}(Co||(Co={})),function(e){e.PROXY="proxy"}(Do||(Do={})),function(e){e.FORK="fork",e.FORGET_ERROR="forgetError",e.LOG="log"}(No||(No={})),function(e){e.USER="user",e.PM_USER="pmUser",e.STATE="state"}(Lo||(Lo={}));var Ro=function(){return"undefined"==typeof window||-1!==window.location.href.indexOf("_generated_background_page.html")},Mo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},$o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Uo=[],Go=!1,qo=C.item("logs");qo.get().then((function(e){(null==e?void 0:e.value)&&(Uo.push.apply(Uo,$o([],Mo(e.value),!1)),qo.setValue(Uo),Go=!0)})),n.g.getLogs=function(){return Uo.slice()};var Fo,Ho=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(Ro())return Uo.unshift($o([Date.now()],Mo(e),!1)),Uo.splice(100,1e3),void(Go&&qo.setValue(Uo));hi(jo(No.LOG,$o([],Mo(e),!1)))},Bo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Vo=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},zo=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(void 0===n.g.debugEnabled||n.g.debugEnabled)&&(console[e].apply(console,t),Ho(Vo([e],Bo(t),!1)))}},Yo=(zo("log"),zo("warn")),Wo=zo("error"),Jo=zo("info"),Ko=zo("debug"),Xo=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function Zo(e,t){void 0===t&&(t=!1);var n=e.Error||e.message||e;if(n instanceof Error)return n.message;if("string"==typeof n)return n;Yo(n);var r="".concat(e).replace(/^TypeError:\s+/,"");if(/\[object/.test(r)){Yo(n);var o=_o(n);return t&&0!==o.length&&"_id"!==o.join(",")?"<pre>"+(JSON.stringify(n,null,2).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#47;")+"</pre>"):po("Error").t(Fo||(Fo=Xo(["Something went wrong. If the problem persists, please try to re-install the extension"],["Something went wrong. If the problem persists, please try to re-install the extension"])))}return r}var Qo,ei,ti={fromSeconds:function(e,t){return(t||0)+1e3*e},fromMinutes:function(e,t){return e*this.fromSeconds(60,t)},fromHours:function(e,t){return e*this.fromMinutes(60,t)},fromDays:function(e,t){return e*this.fromHours(24,t)},toSeconds:function(e){return e/1e3},toMinutes:function(e){return this.toSeconds(e)/60},toHours:function(e){return this.toMinutes(e)/60},toDays:function(e){return this.toHours(e)/24},diffInMilliSeconds:function(e,t){return(t||Date.now())-(e||0)},diffInSeconds:function(e){return this.toSeconds(this.diffInMilliSeconds(e))},diffInMinutes:function(e){return this.toMinutes(this.diffInMilliSeconds(e))},diffInHours:function(e){return this.toHours(this.diffInMilliSeconds(e))},diffInDays:function(e){return this.toDays(this.diffInMilliSeconds(e))}},ni=function(){return ni=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ni.apply(this,arguments)},ri=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},oi=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ii=C.item("crash-reports-disabled"),ai=function(e){var t=e.toString();return t.includes("/envelope/")?{"content-type":"application/x-sentry-envelope"}:t.includes("/store/")?{"content-type":"application/json"}:{}},si=function(e,t){return globalThis.fetch(e,ni(ni({},t),{headers:ni(ni(ni({},null==t?void 0:t.headers),ai(e)),{"x-pm-uid":""})}))},ci=function(e){return function(e,t=V("fetch")){let n=0,r=0;return et(e,(function(o){const i=o.body.length;n+=i,r++;const a={body:o.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return z("fetch"),ce("No fetch implementation available");try{return t(e.url,a).then((e=>(n-=i,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return z("fetch"),n-=i,r--,ce(e)}}))}(e,si)},ui={},li=function(e){if(e){switch("Code"in e?e.Code:void 0){case 86110:case 86111:case 86112:case 86113:case 86114:case 86115:case 86300:return}var t=Zo(e);if(!/Url already open/.test(t)){var n=Date.now();n-((null==ui?void 0:ui[t])||0)<ti.fromMinutes(5)||(ui[t]=n,di().captureException(function(e,t){if(e instanceof Error)return e;var n=new Error(t);return n.previous=e,n}(e,t)))}}},fi=void 0,di=function(){if(fi)return fi;var e=[],t=Mr({}).filter((function(e){return!["BrowserApiErrors","TryCatch","Breadcrumbs","GlobalHandlers"].includes(e.name)})),n=new Vr({dsn:d,release:i,environment:/\.proton.me$/.test(l)?"prod":"test",normalizeDepth:5,transport:ci,stackParser:Zr,autoSessionTracking:!1,integrations:t,sendClientReports:!1,beforeSend:function(t){return ri(this,void 0,void 0,(function(){var n,r;return oi(this,(function(o){switch(o.label){case 0:return[4,ri(void 0,void 0,void 0,(function(){return oi(this,(function(e){switch(e.label){case 0:return[4,ri(void 0,void 0,void 0,(function(){var e;return oi(this,(function(t){switch(t.label){case 0:return[4,ii.getDefined({value:!1})];case 1:return(e=t.sent()).value=!e.value,[2,e]}}))}))];case 1:return[2,e.sent().value]}}))}))];case 1:return o.sent()?(n=Date.now(),r=n-6e5,(e=e.filter((function(e){return e>=r}))).length>5?[2,null]:(e.push(n),[2,t])):[2,null]}}))}))}});return(fi=new Tt).setClient(n),n.init(),fi},pi=function(e){try{return e()}catch(e){throw li(e),e}},hi=function(e){"function"==typeof(null==e?void 0:e.then)&&e.then((function(){}),li)},vi=function(e){"function"==typeof(null==e?void 0:e.catch)&&e.catch((function(){}))},yi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},bi=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},mi=C.item("session",T),gi=C.item("session"),wi=function(){return yi(void 0,void 0,void 0,(function(){var e,t;return bi(this,(function(n){switch(n.label){case 0:return[4,mi.load()];case 1:return(e=n.sent())&&_o(e).length?[2,e]:[4,gi.load()];case 2:return(t=n.sent())&&hi(mi.set(t)),[2,t]}}))}))},_i=C.selfItem("credentials",T),xi=function(){return _i.remove()},Si=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ei=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ki=function(e){return Si(void 0,void 0,void 0,(function(){var t,n,r;return Ei(this,(function(o){switch(o.label){case 0:return[4,wi()];case 1:return t=null===(r=o.sent())||void 0===r?void 0:r.uid,n=(null==e?void 0:e.uid)||t,hi(e.persistent?gi.set(e):gi.remove()),[4,mi.set(e)];case 2:return o.sent(),n===t?[3,4]:[4,xi()];case 3:o.sent(),o.label=4;case 4:return[2]}}))}))},Pi=function(e,t){void 0===t&&(t=!0),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"logout",{enumerable:!0,configurable:!0,writable:!0,value:t}),this.message||(this.message="Missing refresh token")},Oi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ti=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ii=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Ci=!1,Di=[],Ni=function(e){return Oi(void 0,void 0,void 0,(function(){var t,n,r;return Ti(this,(function(o){switch(o.label){case 0:return e?[3,2]:[4,wi()];case 1:e=o.sent(),o.label=2;case 2:if(!e.uid||!e.refreshToken)throw new Pi;return Ci?[4,new Promise((function(e,t){Di.push([e,t])}))]:[3,4];case 3:return[2,o.sent()];case 4:return o.trys.push([4,8,12,13]),Ci=!0,e.expiresAt=Date.now(),[4,ki(e)];case 5:return o.sent(),[4,oa("auth/refresh",Xi("POST",{UID:e.uid,ResponseType:"token",GrantType:"refresh_token",RefreshToken:e.refreshToken,RedirectURI:e.redirectURI||"https://protonvpn.com"},{"x-pm-uid":e.uid}))];case 6:return t=o.sent(),delete e.expiresAt,e.refreshToken=t.RefreshToken,e.accessToken=t.AccessToken,[4,ki(e)];case 7:return o.sent(),Di.forEach((function(t){(0,Ii(t,1)[0])(e)})),Di=[],[2,e];case 8:return n=o.sent(),[4,wi()];case 9:return(r=o.sent()).expiresAt&&r.accessToken===e.accessToken?(delete r.expiresAt,[4,ki(r)]):[3,11];case 10:o.sent(),o.label=11;case 11:if(10013===n.Code){Yo(n,(new Error).stack),n=new Pi(Zo(n));try{hi(jo(Io.SIGN_OUT))}catch(e){}Di.forEach((function(e){(0,Ii(e,2)[1])(n)})),Di=[]}throw n;case 12:return Ci=!1,[7];case 13:return[2]}}))}))},Li=function(e){for(var t=0,n=1,r=3;r>=0;r--)t+=n*Number(e[r]),n*=256;return t},Ai=function(e,t){var n=t.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)\/(\d+)$/);if(!n)return!1;var r=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)(:\d+)?$/);return!!r&&function(e,t){var n=Math.pow(2,32-Number(t[5])),r=Li(t.slice(1,5)),o=Li(e.slice(1,5));return o>=r&&o<r+n}(r,n)},ji=function(e,t){void 0===t&&(t=void 0),Ao(e,t).catch((function(e){-1==="".concat((null==e?void 0:e.message)||e).indexOf("Receiving end does not exist.")&&Wo(e)}))},Ri=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Mi=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},$i=void 0,Ui=C.item("upgrade-error",e.LOCAL,"error"),Gi=function(e){$i={version:i,time:Date.now(),error:e},vi(e?Ui.set($i):Ui.remove())},qi=function(){return Ri(void 0,void 0,void 0,(function(){return Mi(this,(function(e){switch(e.label){case 0:return $i?[3,2]:[4,Ui.get()];case 1:($i=e.sent())||Gi(void 0),e.label=2;case 2:return $i?$i.version!==i||Date.now()-$i.time>ti.fromHours(2)?(Gi(void 0),[2,void 0]):[2,$i.error]:[2,void 0]}}))}))},Fi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Hi=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Bi=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return t&&(e+=Math.round(t*(2*Math.random()-1))),setTimeout.apply(void 0,Hi([n,e],Fi(r),!1))},Vi=function(e,t){return void 0===t&&(t=0),new Promise((function(n){Bi(e,t,n)}))},zi=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=void 0,a=function(){i=Bi(e,t,(function(){n.apply(void 0,Hi([],Fi(r),!1)),a()}))};return a(),{clear:function(){clearTimeout(i)}}},Yi=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Wi=function(){return Wi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Wi.apply(this,arguments)},Ji=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ki=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Xi=function(e,t,n){return void 0===n&&(n={}),{method:e,headers:Wi({Accept:"application/json","Content-Type":"application/json"},n),body:JSON.stringify(t)}},Zi=function(){return"browser-vpn@"+i},Qi={},ea=function(e,t,n,r,o){return Ji(void 0,void 0,void 0,(function(){var i,a,s,c,l,f,d,p,h,v,y,b;return Ki(this,(function(m){switch(m.label){case 0:if(i="".concat((null==t?void 0:t.method)||"GET"," ").concat(e),a=Qi[i]){if(a.time>=Date.now())return[2,a.response.clone()];delete Qi[i]}return(s=(null==t?void 0:t.headers)||{})["x-pm-uid"]?[3,5]:(l=r)?[3,2]:[4,wi()];case 1:l=m.sent(),m.label=2;case 2:return(c=l).expiresAt?[3,3]:(f=null==c?void 0:c.uid,d=null==c?void 0:c.accessToken,f&&d&&Object.assign(s,function(e,t){return{"x-pm-uid":e,Authorization:"Bearer ".concat(t)}}(f,d)),[3,5]);case 3:return!r&&(o||0)<Date.now()?[4,Vi(200)]:[3,5];case 4:return m.sent(),[2,ea(e,t,n,r,o||ti.fromSeconds(8,Date.now()))];case 5:return p=Wi(Wi({mode:"cors",credentials:"include",redirect:"follow",method:"GET"},t),{headers:Wi({"x-pm-appversion":Zi()},s)}),[4,fetch("".concat(n||u).concat(e),p)];case 6:return h=m.sent(),wa(h)&&(v="".concat(h.headers.get("Retry-After")||"0"),y=Math.min(Date.now()+ti.fromMinutes(30),/^\d+$/.test(v)?Date.now()+ti.fromSeconds(Math.max(10,Number(v))):new Date(v).getTime()),((null===(b=Qi[i])||void 0===b?void 0:b.time)||0)<y&&(Qi[i]={time:y,response:h.clone()})),[2,h]}}))}))},ta=function(e){return Ji(void 0,void 0,void 0,(function(){var t;return Ki(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.json()];case 1:return[2,n.sent()];case 2:throw t=n.sent(),Yo(e.status,t),new Error(po("Error").t(ia||(ia=Yi(["Service temporarily unavailable"],["Service temporarily unavailable"]))));case 3:return[2]}}))}))},na=function(e,t){return Ji(void 0,void 0,void 0,(function(){var n;return Ki(this,(function(r){switch(r.label){case 0:return[4,ta(e)];case 1:return n=r.sent(),[2,t?t(e,n):n]}}))}))},ra=function(e){return Ji(void 0,void 0,void 0,(function(){return Ki(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,e.clone().json()];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,e.text()];case 4:return[2]}}))}))},oa=function(e,t,n,r){return Ji(void 0,void 0,void 0,(function(){var o,i,a,s,c,u,l,f,d;return Ki(this,(function(p){switch(p.label){case 0:return[4,qi()];case 1:if(o=p.sent())throw ji("updateExtension",{error:o}),o;return[4,ea(e,t,n)];case 2:return i=p.sent(),va(i)?[3,9]:[4,ra(i)];case 3:if(a=p.sent(),(s=(null==a?void 0:a.Error)?a:new Error(a)).response=i,s&&"object"==typeof s&&(s.httpStatus=i.status),ga(a))throw ji("updateExtension",{error:s}),Gi(a),s;return Gi(void 0),/\/?auth(\/.*)$/.test(e)||!ma(s)?[3,8]:[4,wi()];case 4:return c=p.sent(),u=c.uid,l=c.accessToken,[4,Ni(c)];case 5:return!(f=p.sent()).uid||!f.accessToken||f.uid===u&&f.accessToken===l?[3,7]:[4,ea(e,t,n,f)];case 6:if(d=p.sent(),va(d))return[2,na(d,r)];p.label=7;case 7:Yo(s),p.label=8;case 8:throw s;case 9:return Gi(void 0),[2,na(i,r)]}}))}))};!function(e){e.UPGRADE="Upgrade"}(Qo||(Qo={})),function(e){e.MAIN_ACTION="main_action",e.SECONDARY_ACTION="secondary_action",e.LINK="link"}(ei||(ei={}));var ia,aa,sa,ca,ua,la,fa,da,pa,ha,va=function(e){return e.status>=200&&e.status<300},ya=function(e,t){return"object"==typeof e&&(null==e?void 0:e.httpStatus)===t},ba=function(e){return ya(e,401)},ma=function(e){return ba(e)&&401===e.Code},ga=function(e){return"object"==typeof e&&5003===(null==e?void 0:e.Code)},wa=function(e){return"object"==typeof e&&(429===(null==e?void 0:e.Code)||503===(null==e?void 0:e.Code))},_a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},xa=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Sa=function(){return _a(void 0,void 0,void 0,(function(){var e,t,n;return xa(this,(function(r){switch(r.label){case 0:return[4,wi()];case 1:return(e=null===(t=r.sent())||void 0===t?void 0:t.accessToken)?[3,3]:[4,Ni()];case 2:e=null===(n=r.sent())||void 0===n?void 0:n.accessToken,r.label=3;case 3:return[2,e]}}))}))},Ea=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},ka=function(e,t){var n=chrome.action||chrome.browserAction;n&&(hi(n.setIcon({path:browser.runtime.getURL("/img/"+e)})),"string"==typeof t&&hi(n.setTitle({title:t})))},Pa={loggedOut:function(){return po("Label").t(aa||(aa=Ea(["Unprotected"],["Unprotected"])))},off:function(){return po("Label").t(sa||(sa=Ea(["Unprotected"],["Unprotected"])))},on:function(){return po("Label").t(ca||(ca=Ea(["Protected"],["Protected"])))},error:function(){return po("Error").t(ua||(ua=Ea(["Network error."],["Network error."])))},warning:function(){return po("Error").t(la||(la=Ea(["Network error."],["Network error."])))},connecting:function(){return po("Label").t(fa||(fa=Ea(["Connecting"],["Connecting"])))}},Oa=void 0,Ta=function(e,t){Oa&&clearTimeout(Oa);var n=t||Pa[e](),r=po("Status").t(da||(da=Ea(["Proton VPN: ",""],["Proton VPN: ",""])),n);ka("state-".concat({loggedOut:"not-logged-in",off:"unprotected-1",connecting:"unprotected-2",on:"protected"}[e]||e,".png"),r),"connecting"===e&&(Oa=setTimeout((function(){ka("state-unprotected-1.png",r),Oa=setTimeout((function(){Ta(e,t)}),700)}),700))},Ia=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ca=function(e,t){var n,r;if(void 0===t&&(t=!1),function(e){return"object"==typeof e&&("NetworkError"===(null==e?void 0:e.name)||/^(NetworkError |(TypeError: )?Failed to fetch)/.test((null==e?void 0:e.message)||""))}(e)){Yo(e);var o=cl();if(-1!==(null===(n=o.data.error)||void 0===n?void 0:n.Code)){Ta("warning"),o.data.error={httpStatus:-1,Code:-1,Warning:!0,Error:po("Error").t(pa||(pa=Ia(["Network is unreachable"],["Network is unreachable"])))},null===(r=o.refreshState)||void 0===r||r.call(o);var i=o.data.server;ji("changeState",{state:i?"connected":"disconnected",server:i,error:o.data.error})}if(t)throw e}li(e)},Da=function(e){if(!Ro())throw new Error(e+" is background only")},Na="active";!function(e){e.FAILED="FAILED",e.ABORTED="ABORTED",e.TIMED_OUT="TIMED_OUT",e.BLOCKED_BY_CLIENT="BLOCKED_BY_CLIENT",e.NETWORK_CHANGED="NETWORK_CHANGED",e.NETWORK_IO_SUSPENDED="NETWORK_IO_SUSPENDED",e.TUNNEL_CONNECTION_FAILED="TUNNEL_CONNECTION_FAILED",e.PROXY_CONNECTION_FAILED="PROXY_CONNECTION_FAILED"}(ha||(ha={}));var La,Aa=function(e){return e.replace(/^net::/,"").replace(/^ERR_/,"")},ja=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ra=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ma=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},$a=!1,Ua=0,Ga=void 0,qa=function(e){void 0===e&&(e=!1),Ga||(Ga=setTimeout((function(){return Ra(void 0,void 0,void 0,(function(){var t,n,r;return Ma(this,(function(o){switch(o.label){case 0:if(clearTimeout(Ga),Ga=void 0,Ua=Date.now(),$a)return[2];$a=!0,o.label=1;case 1:return o.trys.push([1,4,5,6]),[4,Vs()];case 2:if(!o.sent())throw new Error(po("Error").t(La||(La=ja(["Unable to reach the server, please try to reconnect, or to log out and log in again if the problem persists"],["Unable to reach the server, please try to reconnect, or to log out and log in again if the problem persists"]))));return[4,null===(r=null===(n=cl())||void 0===n?void 0:n.connectCurrentServer)||void 0===r?void 0:r.call(n)];case 3:return o.sent(),[3,6];case 4:return t=o.sent(),e&&qu(t),[3,6];case 5:return $a=!1,[7];case 6:return[2]}}))}))}),Math.max(1,Ua+ti.fromSeconds(20)-Date.now())))},Fa={},Ha=function(e){if(zu()){var t=e.error;if(t)switch(Aa(t)){case ha.NETWORK_CHANGED:case ha.NETWORK_IO_SUSPENDED:qa();break;case ha.TUNNEL_CONNECTION_FAILED:case ha.PROXY_CONNECTION_FAILED:qa(!0)}else Fa[e.requestId]&&delete Fa[e.requestId]}},Ba=function(e){return!!Fa[e.requestId]},Va=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},za=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ya=function(e,t){return pi((function(){if(!t)throw new Error("asyncBlocking not supported");var n=setTimeout((function(){return pi((function(){t({cancel:!0})}))}),ti.fromSeconds(Math.min(20,m)));hi(function(e){return Va(void 0,void 0,void 0,(function(){return za(this,(function(t){return[2,(n=function(){return Va(void 0,void 0,void 0,(function(){var t;return za(this,(function(n){switch(n.label){case 0:return e.isProxy?Ba(e)?[2,{cancel:!0}]:Lu(e.challenger.host)?(Jo("Auth required for ",e),[4,Vs()]):[3,2]:[3,2];case 1:return[2,(t=n.sent())&&Au(t,e)||{cancel:!0}];case 2:return[2,{}]}}))}))},ri(void 0,void 0,void 0,(function(){var e;return oi(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,n()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),li(e),e;case 3:return[2]}}))})))];var n}))}))}(e).then((function(r){clearTimeout(n),t(r||(e.isProxy&&Lu(e.challenger.host)?{cancel:!0}:{}))})))}))},Wa=function(){return pi((function(){var e;(null===(e=cl())||void 0===e?void 0:e.proxyEnabled)&&hi(Vs())}))},Ja=function(){var e,t,n,r=browser.webRequest;r&&(null===(e=r.onBeforeRequest)||void 0===e||e.removeListener(Wa),null===(t=r.onCompleted)||void 0===t||t.removeListener(Ha),null===(n=r.onErrorOccurred)||void 0===n||n.removeListener(Ha))},Ka=function(){var e,t,n,r,o,i,a=browser.webRequest;if(a){var s={urls:["<all_urls>"]};if(Ja(),null===(e=a.onBeforeRequest)||void 0===e||e.addListener(Wa,s),!(null===(t=a.onAuthRequired)||void 0===t?void 0:t.hasListener(Ya)))try{null===(n=a.onAuthRequired)||void 0===n||n.addListener(Ya,s,["asyncBlocking","extraHeaders"])}catch(e){null===(r=a.onAuthRequired)||void 0===r||r.addListener(Ya,s,["asyncBlocking"])}null===(o=a.onCompleted)||void 0===o||o.addListener(Ha,s),null===(i=a.onErrorOccurred)||void 0===i||i.addListener(Ha,s)}},Xa=function(e){var t=function(e){if("string"!=typeof e)return{};try{var t=JSON.parse(atob(e.split(".")[1]||"")||"{}");return"object"!=typeof t||t instanceof Array?{}:t}catch(e){return{}}}(null==e?void 0:e.Username);return{expiration:t.exp||0,groups:(t.grp||"").split(",").filter(Boolean),sessionId:t.sid||null}},Za=C.selfItem("user",T),Qa=function(e){var t;return"object"==typeof(null===(t=null==e?void 0:e.User)||void 0===t?void 0:t.VPN)},es=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ts=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ns=function(){return es(void 0,void 0,void 0,(function(){var e;return ts(this,(function(t){switch(t.label){case 0:return[4,Za.load()];case 1:return e=t.sent(),Qa(null==e?void 0:e.user)&&(e.user=e.user.User),[2,e]}}))}))},rs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},os=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},is=function(t){return rs(void 0,void 0,void 0,(function(){var n;return os(this,(function(r){switch(r.label){case 0:return[4,C.getItem("backoff-"+t,void 0,e.LOCAL)];case 1:return(n=r.sent())?Date.now()>n.forget?(function(t){hi(C.removeItem("backoff-"+t,e.LOCAL))}(t),[2,!1]):[2,Date.now()<=n.expiration]:[2,!1]}}))}))},as=function(t,n){void 0===n&&(n=5e3),hi(rs(void 0,void 0,void 0,(function(){var r,o,i,a;return os(this,(function(s){switch(s.label){case 0:return[4,C.getItem("backoff-"+t,void 0,e.LOCAL)];case 1:return r=s.sent(),o=((null==r?void 0:r.increment)||0)+1,i=Date.now()+1e3*Math.min(300,Math.pow(n/1e3,(1+o)/2)),a=Date.now()+2e4+1e3*Math.max(15,Math.min(600,Math.pow(n/1e3,(2+o)/2))),[4,C.setItem("backoff-"+t,{increment:o,expiration:i,forget:a},e.LOCAL)];case 2:return s.sent(),[2]}}))})))},ss=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},cs=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},us=C.item("connectedServer",e.SESSION),ls=function(){return ss(void 0,void 0,void 0,(function(){var e,t;return cs(this,(function(n){switch(n.label){case 0:return[4,us.get()];case 1:return[2,!!(null===(t=null===(e=n.sent())||void 0===e?void 0:e.value)||void 0===t?void 0:t.proxyHost)]}}))}))},fs=function(e){var t;return(null===(t=null==e?void 0:e.VPN)||void 0===t?void 0:t.MaxTier)||0},ds=function(){var e,t=!1;n.g.browser||(n.g.browser=chrome);var r=((e={})[Lo.USER]=function(e){var n=e.user;t=function(e){return fs(e)>0}(n)},e);return browser.runtime.onMessage.addListener((function(e){var t,n=null==e?void 0:e.event;return null===(t=r[n])||void 0===t||t.call(r,e),!1})),function(){return!t}}(),ps=function(){return ds()?ti.fromMinutes(30):ti.fromMinutes(10)},hs=function(){return ds()?ti.fromDays(1):ti.fromHours(6)},vs=function(){return 8*hs()},ys=function(){return ds()?ti.fromMinutes(20):ti.fromMinutes(10)},bs=function(){return ti.fromDays(10)},ms=function(){return ms=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ms.apply(this,arguments)},gs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ws=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_s=C.item("location",e.LOCAL),xs=C.item("location-fetching",e.LOCAL);hi(_s.remove());var Ss=function(){return _s.load()},Es=function(){return gs(void 0,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return ws(this,(function(c){switch(c.label){case 0:return[4,Ss()];case 1:return e=c.sent(),t=ps(),(n=ti.diffInMilliSeconds(null==e?void 0:e.time)<t)?[3,3]:[4,is("location")];case 2:n=c.sent(),c.label=3;case 3:if(n)return[2,null==e?void 0:e.location];c.label=4;case 4:return r=Date.now(),[4,xs.get()];case 5:return r-((null===(s=c.sent())||void 0===s?void 0:s.time)||0)<ti.fromSeconds(2)?[4,Vi(200)]:[3,8];case 6:return c.sent(),[4,Ss()];case 7:return o=c.sent(),ti.diffInMilliSeconds(null==o?void 0:o.time)<t?[2,null==o?void 0:o.location]:[3,4];case 8:return[4,gs(void 0,void 0,void 0,(function(){return ws(this,(function(e){switch(e.label){case 0:return[2,!0];case 1:return[2,e.sent()]}}))}))];case 9:if(!c.sent())return[2,null==e?void 0:e.location];c.label=10;case 10:return c.trys.push([10,15,16,17]),[4,xs.setValue(null)];case 11:return c.sent(),[4,oa("vpn/v1/location")];case 12:return(i=c.sent())?[4,_s.set({time:Date.now(),location:i})]:[3,14];case 13:c.sent(),c.label=14;case 14:return[2,i];case 15:if(a=c.sent(),as("location"),a instanceof Pi)throw a;return[2,null==e?void 0:e.location];case 16:return hi(xs.remove()),[7];case 17:return[2]}}))}))},ks=function(e,t,n){return gs(void 0,void 0,void 0,(function(){var r,o;return ws(this,(function(i){switch(i.label){case 0:return[4,Es()];case 1:return r=i.sent(),(o=null==r?void 0:r.IP)&&(t||(t={}),t.headers=ms(ms({},t.headers),{"x-pm-netzone":o.replace(/\.\d+$/,".0"),"x-pm-country":null==r?void 0:r.Country})),[4,oa(e,t,void 0,n)];case 2:return[2,i.sent()]}}))}))},Ps=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Os=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ts=function(e,t,n){return Ps(void 0,void 0,void 0,(function(){var r,o,i,a,s,c;return Os(this,(function(u){switch(u.label){case 0:return[4,ns()];case 1:if(r=(null===(c=null===(s=u.sent())||void 0===s?void 0:s.user)||void 0===c?void 0:c.VPN)||{},o=r.MaxTier,i=r.Groups,t||(t={}),"number"!=typeof o)throw new Error("Cannot fetch ".concat(e," while not authenticated"));return Object.assign(t.headers||(t.headers={}),{"x-pm-max-tier":"".concat(o)}),i&&(a=i.length,Object.assign(t.headers||(t.headers={}),1===a?{"x-pm-single-group":i.join(",")}:{"x-pm-group-count":a})),[4,ks(e,t,n)];case 2:return[2,u.sent()]}}))}))},Is=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Cs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ds=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ns=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Da("credentials");var Ls,As,js=!1,Rs=[],Ms=0,$s=null,Us=void 0,Gs=function(){$s&&clearTimeout($s)},qs=function(e,t){var n=1e3*Xa(null==Us?void 0:Us.credentials).expiration,r=Date.now(),o=ti.fromSeconds(e.Expire,r),i=ti.fromSeconds(e.Expire/2,r);Us={time:n?Math.min(n,o):o,halfLife:n?Math.min((r+n)/2,i):i,credentials:e,sessionUid:t},hi(_i.set(Us))},Fs=function(e,t){return void 0===t&&(t=!0),Cs(void 0,void 0,void 0,(function(){var n,r,o,i,a,s,c,u,l,f,d;return Ds(this,(function(p){switch(p.label){case 0:js=!0,Ms++,p.label=1;case 1:return p.trys.push([1,6,9,11]),Ms>1?[4,Vi(Math.pow(2,Ms-2)*(500+1500*Math.random()))]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,Ts("vpn/v1/browser/token?Duration="+b,{headers:{"x-pm-try-number":"".concat(Ms)}})];case 4:return n=p.sent(),[4,null===(c=null===(s=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===s?void 0:s.handlerBehaviorChanged)||void 0===c?void 0:c.call(s)];case 5:return p.sent(),Ms=0,r=cl(),n&&(qs(n,e),r.proxyEnabled&&(Ka(),"function"==typeof r.setCredentials&&r.setCredentials(n)),Ko("Fetch at "+Date.now()+", expires at "+((null==Us?void 0:Us.time)||"unknown time"))),o=r.data,r.proxyEnabled&&(null===(u=o.error)||void 0===u?void 0:u.Warning)&&(delete o.error,i=(null===(l=o.server)||void 0===l?void 0:l.name)||"",Ta("on","".concat(po("Label").t(Ls||(Ls=Is(["Protected"],["Protected"])))," - ").concat(i))),[2,n];case 6:return(a=p.sent())._id=Date.now()+"-"+Math.random(),t&&ma(a)?(Ms--,[4,Ni()]):[3,8];case 7:return p.sent(),[2,Fs(e,!1)];case 8:try{Ca(a,!0)}catch(e){return[2,void 0]}throw!function(e){return"object"==typeof e&&(2028===(null==e?void 0:e.Code)||2027===(null==e?void 0:e.Code))}(a)?"active"===Na&&(function(e){return ya(e,403)}(a)||Ms>2||!wa(a))&&qu(a):(Yo(a,(new Error).stack),Gu(!0)),a;case 9:return js=!1,[4,null===(d=null===(f=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===f?void 0:f.handlerBehaviorChanged)||void 0===d?void 0:d.call(f)];case 10:return p.sent(),[7];case 11:return[2]}}))}))},Hs=function(e){return Cs(void 0,void 0,void 0,(function(){var t,n,r;return Ds(this,(function(o){switch(o.label){case 0:if(js)return[2,new Promise((function(e,t){Rs.push([e,t])}))];if((null==Us?void 0:Us.halfLife)&&e&&Us.sessionUid===e&&Date.now()<Us.halfLife)return[2,Us.credentials];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Fs(e)];case 2:if(1e3!==(null==(t=o.sent())?void 0:t.Code))throw new Error(Zo(t||{error:"No credentials found"}));return Rs.forEach((function(e){(0,Ns(e,1)[0])(t)})),Rs=[],js=!1,qs(t,e),n=.1*ti.fromSeconds(t.Expire),Gs(),$s=Bi(ti.fromSeconds(t.Expire)-n,n,(function(){return Cs(void 0,void 0,void 0,(function(){var t,r,o,i;return Ds(this,(function(a){switch(a.label){case 0:return $s=null,[4,Bs()];case 1:return t=a.sent(),(r=((null==t?void 0:t.time)||0)>=Date.now()-2*n&&!js)?(o=e,[4,wi()]):[3,3];case 2:r=o===(null===(i=a.sent())||void 0===i?void 0:i.uid),a.label=3;case 3:return r&&hi(Hs(e)),[2]}}))}))})),[2,t];case 3:throw r=o.sent(),Rs.forEach((function(e){(0,Ns(e,2)[1])(r)})),Rs=[],js=!1,r;case 4:return[2]}}))}))},Bs=function(){return _i.load()},Vs=function(e){return void 0===e&&(e=!1),Cs(void 0,void 0,void 0,(function(){var t,n,r,o;return Ds(this,(function(i){switch(i.label){case 0:return[4,wi()];case 1:return(t=null===(o=i.sent())||void 0===o?void 0:o.uid)?[4,Sa()]:[2,void 0];case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,5,,7]),[4,Cs(void 0,void 0,void 0,(function(){var e;return Ds(this,(function(n){switch(n.label){case 0:return[4,Bs()];case 1:return((null==(e=n.sent())?void 0:e.time)||0)<Date.now()?[2,Hs(t)]:[2,null==e?void 0:e.credentials]}}))}))];case 4:return(n=i.sent())||!e?[2,n]:[3,7];case 5:if(r=i.sent(),!e||!ba(r))throw r;return[4,ki({})];case 6:return i.sent(),[3,7];case 7:return[4,Ni()];case 8:return i.sent(),[2,Vs()]}}))}))};!function(e){e.CLEAR="clear",e.DEFAULT="default",e.DISABLED="disable_non_proxied_udp"}(As||(As={}));var zs=function(e){return new Promise((function(t){chrome.privacy?e!==As.CLEAR?chrome.privacy.network.webRTCIPHandlingPolicy.set({value:e},(function(){chrome.privacy.network.webRTCIPHandlingPolicy.get({},(function(n){var r,o;t(("controlled_by_this_extension"===(o=null==(r=n)?void 0:r.levelOfControl)||"controllable_by_this_extension"===o?null==r?void 0:r.value:void 0)===e)}))})):chrome.privacy.network.webRTCIPHandlingPolicy.clear({},t):t(!1)}))},Ys=C.item("prevent-webrtc-leak"),Ws=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Js=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ks=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Xs=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Zs=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Qs=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Da("proxy");var ec,tc=function(e){return"fixed_servers"===e.mode},nc=!1,rc=!1,oc=function(e){return new Promise((function(t){chrome.proxy&&fl()?(nc=!0,Ka(),chrome.proxy.settings.set({value:e,scope:"regular"},(function(){sc().then((function(e){var t,n,r=null===(n=null===(t=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===t?void 0:t.handlerBehaviorChanged)||void 0===n?void 0:n.call(t);return r?r.then((function(){return e})):e})).then((function(e){var n,r;rc||(rc=!0,null===(r=null===(n=chrome.proxy.onProxyError)||void 0===n?void 0:n.addListener)||void 0===r||r.call(n,(function(e){return Ks(void 0,void 0,void 0,(function(){return Xs(this,(function(t){switch(Aa(e.error)){case ha.TIMED_OUT:case ha.TUNNEL_CONNECTION_FAILED:case ha.PROXY_CONNECTION_FAILED:qa(!0)}return[2]}))}))}))),t(e)}))})),hi(tc(e)?Ws(void 0,void 0,void 0,(function(){return Js(this,(function(e){switch(e.label){case 0:return[4,Ys.getDefined({value:!0})];case 1:return[4,e.sent().value?zs(As.DISABLED):zs(As.CLEAR)];case 2:return e.sent(),[2]}}))})):zs(As.CLEAR))):t(!1)}))},ic=function(e,t,n){return void 0===n&&(n=[]),{mode:"fixed_servers",rules:{singleProxy:{scheme:S,host:e,port:t},bypassList:Qs(Qs(Qs([],Zs(n),!1),Zs(p),!1),Zs(h),!1)}}},ac=function(){return new Promise((function(e){chrome.proxy?(nc=!1,chrome.proxy.settings.clear({},(function(t){nc||(Ja(),hi(zs(As.CLEAR))),e(Boolean(t))}))):e(!1)}))},sc=function(){return Ks(void 0,void 0,void 0,(function(){return Xs(this,(function(e){switch(e.label){case 0:return[4,(t=new Promise((function(e){chrome.proxy?chrome.proxy.settings.get({},(function(t){return Ks(void 0,void 0,void 0,(function(){var n,r,o,i,a;return Xs(this,(function(s){switch(s.label){case 0:return n=e,(r="controlled_by_this_extension"===(null==t?void 0:t.levelOfControl))?[3,5]:(null===(a=null==t?void 0:t.value)||void 0===a?void 0:a.mode)?(o=tc(null==t?void 0:t.value),[3,4]):[3,1];case 1:return(i="controllable_by_this_extension"===(null==t?void 0:t.levelOfControl))?[4,ls()]:[3,3];case 2:i=s.sent(),s.label=3;case 3:o=i,s.label=4;case 4:r=o,s.label=5;case 5:return n.apply(void 0,[r]),[2]}}))}))})):e(!1)})),n=ti.fromSeconds(5),r="Unable to check proxy settings",void 0===o&&(o=Error),new Promise((function(e,i){var a=!1,s=setTimeout((function(){a=!0,i(new o(r||"Timeout"))}),n);t.then((function(t){a||(e(t),clearTimeout(s))})).catch(i)})))];case 1:return[2,e.sent()]}var t,n,r,o}))}))},cc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},uc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},lc=function(e,t){return"string"==typeof e&&"string"==typeof t?e.localeCompare(t):e>t?1:e<t?-1:0},fc=(function(){function e(e){Object.defineProperty(this,"transformer",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"sortingCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]})}Object.defineProperty(e.prototype,"getField",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.transformer?this.transformer.apply(this,uc([e],cc(t),!1)):e}}),Object.defineProperty(e.prototype,"sort",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.sortingCallbacks.length&&e.sort((function(e,r){var o=t.getField.apply(t,uc([e],cc(n),!1)),i=t.getField.apply(t,uc([r],cc(n),!1)),a=0;return t.sortingCallbacks.some((function(e){return a=e(o,i)})),a}))}}),Object.defineProperty(e.prototype,"asc",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.sortingCallbacks.push((function(t,n){return lc(null==t?void 0:t[e],null==n?void 0:n[e])})),this}}),Object.defineProperty(e.prototype,"desc",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.sortingCallbacks.push((function(t,n){return lc(null==n?void 0:n[e],null==t?void 0:t[e])})),this}})}(),function(e){return function(e){return e&&"object"==typeof e&&"number"==typeof(null==e?void 0:e.time)}(e)?Date.now()-e.time:1/0}),dc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},hc={},vc=function(t,n){return dc(void 0,void 0,void 0,(function(){var r,o,i;return pc(this,(function(a){switch(a.label){case 0:return[4,oa("vpn/v1/cities/names")];case 1:return r=a.sent(),(o=r.Cities)?(i={time:Date.now(),value:o},hc[n]=i,hi(C.setItem("city-names-"+t,i,e.LOCAL)),[2,o]):[2,{}]}}))}))},yc=function(t,n){return dc(void 0,void 0,void 0,(function(){var r;return pc(this,(function(o){switch(o.label){case 0:return hc[t]?[2,hc[t]]:[4,C.getItem("city-names-"+n,void 0,e.LOCAL)];case 1:return(r=o.sent())&&(hc[t]=r),[2,r]}}))}))},bc=function(e,t){return void 0===t&&(t=!1),dc(void 0,void 0,void 0,(function(){var n,r,o,i;return pc(this,(function(a){switch(a.label){case 0:return n=navigator.languages||[mo()],/^en(-.*)$/.test("".concat(n[0]||""))?[2,{}]:(r=n.join("/"),o=(e||"")+":"+r,t?[3,2]:[4,yc(o,r)]);case 1:if(i=a.sent(),fc(i)<ti.fromDays(20))return[2,(null==i?void 0:i.value)||{}];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,vc(r,o)];case 3:return[2,a.sent()];case 4:return a.sent(),[2,{}];case 5:return[2]}}))}))};!function(e){e[e.SECURE_CORE=1]="SECURE_CORE",e[e.TOR=2]="TOR",e[e.P2P=4]="P2P",e[e.STREAMING=8]="STREAMING",e[e.IPV6=16]="IPV6",e[e.RESTRICTED=32]="RESTRICTED",e[e.PARTNER=64]="PARTNER"}(ec||(ec={}));var mc=function(e){return!(!(e&&e.Status>0)||3&(e.ServicesDown||0))},gc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},wc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_c=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},xc=C.item("logicals-servers",e.LOCAL),Sc={},Ec=function(){hi(xc.remove())},kc=function(e){return gc(void 0,void 0,void 0,(function(){var t,n,r,o,i,a;return wc(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=null==e?void 0:e.lastModified,[4,Ts("vpn/v1/logicals",{headers:{"If-Modified-Since":t||"Thu, 01 Jan 1970 00:00:00 GMT"}},(function(e,t){return{logicals:null==t?void 0:t.LogicalServers,lastModified:e.headers.get("Last-Modified")}}))];case 1:return n=s.sent(),r=n.logicals,o=n.lastModified,r.forEach(Tc),hi(xc.setValue(r,{lastModified:o})),hi(bc()),[2,r];case 2:if(i=s.sent(),null==e?void 0:e.value)return function(e){return 304===(null==e?void 0:e.status)||ya(e,304)}(a=null==i?void 0:i.response)&&hi(xc.setValue(e.value,{lastModified:a.headers.get("Last-Modified")})),[2,e.value];throw i;case 3:return[2]}}))}))},Pc=function(){return gc(void 0,void 0,void 0,(function(){var e;return wc(this,(function(t){switch(t.label){case 0:return[4,gc(void 0,void 0,void 0,(function(){var e,t;return wc(this,(function(n){switch(n.label){case 0:return[4,xc.get()];case 1:return e=n.sent(),t=fc(e),e&&t<hs()?[2,e.value]:e&&t<vs()?(hi(kc(e)),[2,e.value]):[4,kc(e)];case 2:return[2,n.sent()]}}))}))];case 1:return function(e){e.sort((function(e,t){if(e.SearchScore!==t.SearchScore)return lc(t.SearchScore,e.SearchScore);if(e.ExitCountry!==t.ExitCountry)return lc(e.ExitCountry,t.ExitCountry);var n=_c(e.Name.split("#",2),2),r=n[0],o=n[1],i=_c(t.Name.split("#",2),2),a=i[0],s=i[1];return r===a?/^\d+$/.test(o||"0")&&/^\d+$/.test(s||"0")?lc(parseInt(o||"0",10),parseInt(s||"0",10)):lc(o,s):lc(r,a)}))}(e=t.sent().filter((function(e){return e.Tier<=(n.g.logicalMaxTier||2)&&(y||!(e.Features&(ec.TOR|ec.RESTRICTED)))}))),e.forEach((function(e){Sc[e.ID]=e})),[2,e]}}))}))},Oc=function(e){return Sc[e]},Tc=function(e){e._up=e.Status>0&&(e.Servers||[]).some(mc)},Ic=function(e){return void 0===e._up&&Tc(e),e._up},Cc=C.item("notifications-enabled"),Dc=function(){return Dc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Dc.apply(this,arguments)};function Nc(e,t,n){Cc.getDefined({value:!0}).then((function(r){var o;r.value&&("string"==typeof t&&(t={message:t}),null===(o=null===chrome||void 0===chrome?void 0:chrome.notifications)||void 0===o||o.create("proton-vpn-"+e,Dc({type:"basic",title:"Proton VPN",iconUrl:"/img/icon-512.png"},t),n))}))}var Lc,Ac=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},jc=function(e,t){var n=(e||[]).filter((function(e){return Ic(e)&&t>=e.Tier})),r=1/0,o=void 0;return n.forEach((function(e){e.Score<r&&(r=e.Score,o=e)})),o},Rc=function(e,t,n){var r=jc(e,t);if(!r)throw null==n||n(new Error(po("Error").t(Lc||(Lc=Ac(["Unable to find appropriate server, try to logout and login again if it persists"],["Unable to find appropriate server, try to logout and login again if it persists"]))))),new Error("Missconfigured server. Cannot find the best one.");return r},Mc=function(e){var t=((null==e?void 0:e.Servers)||[]).filter(mc);return t[Math.floor(Math.random()*t.length)]},$c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Uc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Gc=function(e){return $c(void 0,void 0,void 0,(function(){var t;return Uc(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ts("vpn/v1/logicals/".concat(e,"/alternatives"))];case 1:return[2,n.sent().Alternatives||[]];case 2:return t=n.sent(),Yo(t),[2,[]];case 3:return[2]}}))}))},qc=function(e){return $c(void 0,void 0,void 0,(function(){var t,n,r,o;return Uc(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Gc(e)];case 1:return t=i.sent(),(n=t.length)?[2,{logical:r=t[Math.floor(Math.random()*n)],server:Mc(r)}]:[2,{}];case 2:return o=i.sent(),Yo(o,(new Error).stack),[2,{}];case 3:return[2]}}))}))},Fc=function(e,t){return $c(void 0,void 0,void 0,(function(){var n,r,o,i,a,s,c;return Uc(this,(function(u){switch(u.label){case 0:return[4,qc(e)];case 1:return n=u.sent(),r=n.server,o=n.logical,r&&o?[2,{server:r,logical:o}]:[4,Pc()];case 2:if(i=u.sent(),a=i.find((function(t){return t.ID===e})),!a)return[2,{}];for(s=[function(t){return t.ID!==e},function(e){return e.Tier<=a.Tier},function(e){return(e.Features&ec.SECURE_CORE)==(a.Features&ec.SECURE_CORE)},function(e){return e.ExitCountry===a.ExitCountry},function(e){return e.Features===(a.Features&~ec.RESTRICTED)}];s.length>2;){if(c=jc(i.filter((function(e){return s.every((function(t){return t(e)}))})),t),c)return[2,{logical:c,server:Mc(c)}];s.pop()}return[2,{server:r,logical:o}]}}))}))},Hc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Bc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Vc=C.item("last-choice",e.LOCAL),zc=function(){return hi(Vc.remove())},Yc=function(){return Hc(void 0,void 0,void 0,(function(){var e;return Bc(this,(function(t){switch(t.label){case 0:return[4,Vc.get()];case 1:return[2,(null===(e=t.sent())||void 0===e?void 0:e.value)||{connected:!1}]}}))}))},Wc=function(e,t,n){return t.logicalId?n?n(t.logicalId):e.filter((function(e){return e.ID===t.logicalId})):e.filter((function(e){return!(e.Features&(ec.TOR|ec.RESTRICTED|ec.PARTNER))&&(("other"!==t.filter||!(e.Features&ec.TOR||e.Tier>0||e.City))&&(("number"!=typeof t.tier||e.Tier===t.tier)&&(!(t.excludedFeatures&&e.Features&t.excludedFeatures)&&(!(t.requiredFeatures&&!(e.Features&t.requiredFeatures))&&((!t.exitCountry||e.ExitCountry===t.exitCountry)&&((!t.entryCountry||e.EntryCountry===t.entryCountry)&&(!t.city||e.City===t.city)))))))}))},Jc=function(e){var t;return void 0!==(null===(t=null==e?void 0:e.User)||void 0===t?void 0:t.Name)},Kc=C.item("pmUser",T),Xc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Zc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Qc=function(){return Xc(void 0,void 0,void 0,(function(){var e;return Zc(this,(function(t){switch(t.label){case 0:return[4,oa("users")];case 1:return(e=t.sent())&&(Vu()||Uu(),hi(Kc.set({time:Date.now(),user:e}))),[2,Jc(e)?e.User:e]}}))}))},eu=function(){return Xc(void 0,void 0,void 0,(function(){var e,t,n;return Zc(this,(function(r){switch(r.label){case 0:return[4,Xc(void 0,void 0,void 0,(function(){var e;return Zc(this,(function(t){switch(t.label){case 0:return[4,Kc.load()];case 1:return e=t.sent(),Jc(null==e?void 0:e.user)&&(e.user=e.user.User),[2,e]}}))}))];case 1:if(e=r.sent(),(t=fc(e))<(ds()?ti.fromMinutes(20):ti.fromMinutes(10)))return[2,null==e?void 0:e.user];if(t<ti.fromDays(3))return hi(Qc()),[2,null==e?void 0:e.user];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Qc()];case 3:return[2,r.sent()];case 4:if(n=r.sent(),null==e?void 0:e.user)return[2,e.user];throw n;case 5:return[2]}}))}))},tu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},nu=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ru=[],ou=function(){return tu(void 0,void 0,void 0,(function(){var e;return nu(this,(function(t){switch(t.label){case 0:return[4,oa("vpn/v2")];case 1:return(e=t.sent())&&(Vu()||Uu(),hi(Za.setValue(e))),[2,e]}}))}))},iu=function(e){return tu(void 0,void 0,void 0,(function(){var t,n,r,o,i,a,s;return nu(this,(function(c){switch(c.label){case 0:return[4,ns()];case 1:if(t=c.sent(),n=fc(t),r=e&&((null===(s=t.user)||void 0===s?void 0:s.VPN.MaxTier)||0)<1,o=ys(),n<(r?ti.fromSeconds(1):o))return[2,null==t?void 0:t.user];if(!r&&n<ti.fromDays(3))return hi(tu(void 0,void 0,void 0,(function(){var e;return nu(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,7]),[4,Sa()];case 1:return t.sent(),[4,ou()];case 2:return t.sent(),[3,7];case 3:return e=t.sent(),ba(e)?[4,Ni()]:[3,6];case 4:return t.sent(),[4,Promise.all([ou(),Qc()])];case 5:return t.sent(),[2];case 6:throw Ca(e),e;case 7:return[2]}}))}))),[2,null==t?void 0:t.user];i=Date.now(),(ru=ru.filter((function(e){return e<i-o}))).push(i),c.label=2;case 2:return c.trys.push([2,4,5,6]),[4,ou()];case 3:return[2,c.sent()];case 4:if(a=c.sent(),null==t?void 0:t.user)return[2,t.user];throw a;case 5:return e&&hi(Qc()),[7];case 6:return[2]}}))}))},au=function(e,t){return void 0===e&&(e=!1),tu(void 0,void 0,void 0,(function(){var n,r,o,i;return nu(this,(function(a){switch(a.label){case 0:return[4,wi()];case 1:return(null===(i=a.sent())||void 0===i?void 0:i.uid)?[4,Sa()]:[2,void 0];case 2:a.sent(),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,iu(t&&(s=Date.now(),(ru=ru.filter((function(e){return e<s-ys()}))).length<20))];case 4:return(n=a.sent())||!e?[2,Qa(n)?n.User:n]:[3,6];case 5:if(r=a.sent(),!e||!ba(r))throw r;return[3,6];case 6:return[4,Ni()];case 7:return a.sent(),[4,iu()];case 8:return o=a.sent(),[2,Qa(o)?o.User:o]}var s}))}))},su=function(e,t){return void 0===e&&(e=!1),tu(void 0,void 0,void 0,(function(){var r;return nu(this,(function(o){switch(o.label){case 0:return[4,au(e,t)];case 1:return r=o.sent(),n.g.browser||(n.g.browser=chrome),vi(browser.runtime.sendMessage({event:Lo.USER,user:r})),[2,r]}}))}))},cu=function(){return su(!0,!0)},uu=function(){return hi(Za.remove())},lu=function(){return hi(Kc.remove())},fu=function(){return fu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},fu.apply(this,arguments)};function du(e,t){void 0===t&&(t={}),t.error instanceof Error&&(t.error={message:t.error.message,stack:t.error.stack}),ji("changeState",fu({state:e},t))}var pu,hu=C.item("split-tunneling"),vu=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},yu=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},bu=function(e,t){if(e<1)return[];var n=[];return t.forEach((function(e){n.push.apply(n,yu([e.domain],vu(e.withSubDomains?["."+e.domain]:[]),!1))})),n},mu=function(e,t){return function(n){return!!(n.Features&ec.SECURE_CORE)===(e>0&&t.value)}},gu=function(e){return-1!==Xa(e).groups.indexOf("vpn-paid")?2:0},wu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},_u=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},xu={},Su=function(e,t,n,r,o){return wu(void 0,void 0,void 0,(function(){var i,a;return _u(this,(function(s){switch(s.label){case 0:return[4,Vi(o)];case 1:if(s.sent(),Date.now()-(xu[e]||0)<ti.fromMinutes(30))return[2];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,fetch("http://".concat(e,"/vpn/v1/browser/token"),{method:"HEAD",headers:t&&n?{"x-pm-vpn-authorization":"".concat(t,".").concat(n)}:{}})];case 3:if(403===(i=s.sent()).status)return xu[e]=Date.now(),[2];if(!va(i))throw new Error("".concat(i.status||""," ").concat(i.statusText).trim());return[3,6];case 4:if(a=s.sent(),r>4)throw a;return[4,Su(e,t,n,r+1,{1:500,2:ti.fromSeconds(2),3:ti.fromSeconds(6)}[r]||ti.fromSeconds(12))];case 5:return s.sent(),[3,6];case 6:return[2]}}))}))},Eu=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},ku=function(){return ku=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ku.apply(this,arguments)},Pu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ou=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Tu=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Iu=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Cu=0;Da("state");var Du=function(){var e,t;return!!(null===(t=null===(e=null==pu?void 0:pu.data)||void 0===e?void 0:e.error)||void 0===t?void 0:t.Warning)},Nu={},Lu=function(e){var t,n;return e===(null===(n=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost)||/^(.*\.)?protonvpn(\.net|\.com)(:\d+)?$/.test(e)||!!Nu[e]};function Au(e,t){var n,r,o=pu.data;if(!e||(null===(n=o.credsData)||void 0===n?void 0:n.Username)===e.Username&&(null===(r=o.credsData)||void 0===r?void 0:r.Password)===e.Password||Object.assign(o,{credsTry:0,credsData:e}),o.credsData)return{authCredentials:{username:o.credsData.Username,password:o.credsData.Password}}}var ju={name:"on",initializedAt:0,proxyEnabled:!1,refreshingState:!1,init:function(e){if(this.proxyEnabled=!1,pu.data=ku(ku(ku({credsData:void 0},null==e?void 0:e.data),pu.data),{starting:!0}),void 0===pu.data.server)return $u(Mu)},connectCurrentServer:function(){var e;return Pu(this,void 0,void 0,(function(){var t,n;return Ou(this,(function(r){switch(r.label){case 0:return t=null===(e=null==pu?void 0:pu.data)||void 0===e?void 0:e.server,Jo(t),(n=!!t)?[4,this.setProxy(t,t.bypassList||[])]:[3,2];case 1:n=r.sent(),r.label=2;case 2:return[2,n]}}))}))},setOption:function(e,t){var n;return Pu(this,void 0,void 0,(function(){return Ou(this,(function(r){switch(r.label){case 0:return e===Co.BYPASS_LIST?[3,1]:[3,4];case 1:return(null===(n=null==pu?void 0:pu.data)||void 0===n?void 0:n.server)?(pu.data.server.bypassList=t,[4,this.connectCurrentServer()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[3,4];case 4:return[2]}}))}))},setProxy:function(e,t){var n,r;return void 0===t&&(t=[]),Pu(this,void 0,void 0,(function(){var o,i;return Ou(this,(function(a){switch(a.label){case 0:return(null===(n=pu.data)||void 0===n?void 0:n.starting)&&delete pu.data.starting,Nu[e.proxyHost]=!0,[4,Vs()];case 1:return o=a.sent(),(i=!o)?[3,3]:[4,Bs()];case 2:i=((null===(r=a.sent())||void 0===r?void 0:r.time)||0)<Date.now(),a.label=3;case 3:return i?(Yo(o?"Expired token":"No token"),[2,!1]):[4,oc(ic(e.proxyHost,e.proxyPort,t))];case 4:return a.sent()?(this.proxyEnabled=!0,hi(this.checkLogicalIsUp(o)),[2,!0]):[2,!1]}}))}))},setConnected:function(){var e,t,n;return Pu(this,void 0,void 0,(function(){var r,o,i,a,s,c;return Ou(this,(function(u){switch(u.label){case 0:return(null===(e=null==pu?void 0:pu.data)||void 0===e?void 0:e.server)?(r=Date.now(),o=pu,i=pu.data.server,a=pu.data.server.name,Cu=r,[4,this.connectCurrentServer()]):(qu(new Error(po("Error").t(Wu||(Wu=Eu(["Server not found"],["Server not found"]))))),[2]);case 1:return u.sent()?((s=null===(t=pu.data.server)||void 0===t?void 0:t.proxyHost)&&(c=null===(n=null==pu?void 0:pu.data)||void 0===n?void 0:n.credsData,function(e,t,n){vi(Su(e,t,n,1,300))}(s,null==c?void 0:c.Username,null==c?void 0:c.Password)),setTimeout((function(){var e;if(o===pu&&(null===(e=pu.data.server)||void 0===e?void 0:e.name)===a){du("connected",{server:i,error:pu.data.error});var t=a||"";Ta("on","".concat(po("Label").t(Ku||(Ku=Eu(["Protected"],["Protected"])))," - ").concat(t))}}),Math.max(1,200-(new Date).getTime()+r)),[2]):(qu(new Error(po("Error").t(Ju||(Ju=Eu(["Not able to control the browser network settings, possibly a permission is missing"],["Not able to control the browser network settings, possibly a permission is missing"]))))),[2])}}))}))},setCredentials:function(e){var t,n,r=null==e?void 0:e.Username,o=null==e?void 0:e.Password;if(r&&o){var i=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.credsData;r!==(null==i?void 0:i.Username)||o!==(null==i?void 0:i.Password)?function(e,t){if(!e||!t)return!0;var n=Xa(e),r=Xa(t);return n.sessionId!==r.sessionId||r.expiration>n.expiration}(i,e)&&(Object.assign(pu.data,{credsTry:0,credsData:{Username:r,Password:o}}),hi(this.setConnected())):(null===(n=pu.data)||void 0===n?void 0:n.starting)&&hi(this.setConnected())}},checkLogicalIsUp:function(e){var t,n,r,o;return Pu(this,void 0,void 0,(function(){var i,a,s,c,u,l,f,d,p,h;return Ou(this,(function(v){switch(v.label){case 0:if(i=Date.now(),!(a=null===(n=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.id)||i-Cu<(ds()?ti.fromMinutes(20):ti.fromMinutes(5)))return[2];s=this.initializedAt,Cu=i,v.label=1;case 1:return v.trys.push([1,9,,10]),[4,Vi(500)];case 2:return v.sent(),this.proxyEnabled&&zu()?[4,Ts("vpn/v1/logicals?ID[]="+a)]:[2];case 3:return(c=v.sent().LogicalServers)[0]&&Ic(c[0])?[3,8]:(l=e)?[3,5]:[4,Vs(!0)];case 4:l=v.sent(),v.label=5;case 5:return(u=l)?[4,Fc(a,gu(u))]:[3,8];case 6:return f=v.sent(),d=f.server,(p=f.logical)&&d&&s===cl().initializedAt?[4,Fu(p,d,null===(o=null===(r=null==pu?void 0:pu.data)||void 0===r?void 0:r.server)||void 0===o?void 0:o.bypassList)]:[3,8];case 7:v.sent(),v.label=8;case 8:return[3,10];case 9:return h=v.sent(),Ca(h),[3,10];case 10:return[2]}}))}))},refreshState:function(){var e,t,n;return Pu(this,void 0,void 0,(function(){var r,o,i,a,s;return Ou(this,(function(c){switch(c.label){case 0:if(this.refreshingState)return[2];this.refreshingState=!0,c.label=1;case 1:return c.trys.push([1,,10,11]),hi(this.checkLogicalIsUp()),(r=!(null===(e=pu.data)||void 0===e?void 0:e.starting))?[4,sc()]:[3,3];case 2:r=c.sent(),c.label=3;case 3:if(r)return[2];c.label=4;case 4:return c.trys.push([4,8,,9]),[4,Cs(void 0,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return Ds(this,(function(c){switch(c.label){case 0:return[4,Bs()];case 1:return e=c.sent(),t=((null==e?void 0:e.time)||0)-Date.now(),n=null==e?void 0:e.credentials,t<0&&!js?t<ti.fromSeconds(-20)||!n?(r=Hs,[4,wi()]):[3,3]:[3,5];case 2:return[2,r.apply(void 0,[null===(a=c.sent())||void 0===a?void 0:a.uid])];case 3:return o=hi,i=Hs,[4,wi()];case 4:o.apply(void 0,[i.apply(void 0,[null===(s=c.sent())||void 0===s?void 0:s.uid])]),c.label=5;case 5:return[2,n]}}))}))];case 5:return(o=c.sent())?(this.setCredentials(o),[2]):Du()?[2]:(i=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server,a=(null==i?void 0:i.name)||"",du("connecting",{server:i}),Ta("connecting",po("Status").t(Xu||(Xu=Eu(["Connecting to ",""],["Connecting to ",""])),a)),[4,Vs(!0)]);case 6:if(o=c.sent(),!(Du()||(null==o?void 0:o.Username)&&(null==o?void 0:o.Password)))return $u(Mu),[2];if(this.setCredentials(o),!(null===(n=null==pu?void 0:pu.data)||void 0===n?void 0:n.server))throw new Error("No server");return[4,this.connectCurrentServer()];case 7:return c.sent(),[3,9];case 8:return qu(s=c.sent()),li(s),[3,9];case 9:return[3,11];case 10:return this.refreshingState=!1,[7];case 11:return[2]}}))}))},handleProxyRequest:function(e){var t,n,r=Iu(Iu([],Tu(h),!1),Tu((null===(n=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.bypassList)||[]),!1);if(function(e,t,n){var r=new URL(e.url),o=r.hostname;return!(-1===p.indexOf(o)||!t&&!/^\/?(api\/)?vpn\/location(\?.*)?$/.test(r.pathname))||(n||[]).some((function(t){return"."===t.charAt(0)?new RegExp(t.replace(".","\\.")+"$").test(o):!!Ai(o,t)||(/[*\\/]/.test(t)?-1!==t.indexOf("/")?new RegExp("^"+(-1===t.indexOf("//")?"([^/]+.)?":"")+t.replace(".","\\.").replace("*",".*")).test(0===t.indexOf("://")?e.url.replace(/^[a-z]+(:\/\/)/,"$1"):0===t.indexOf("//")?e.url.replace(/^[a-z]+:(\/\/)/,"$1"):e.url):new RegExp(t.replace(".","\\.").replace("*",".*")+"$").test(o):o===t)}))}(e,f,r))return{type:"direct"};var o=function(e){var t,n,r,o,i,a,s,c=ku({type:S,host:null===(n=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost,port:null===(o=null===(r=null==pu?void 0:pu.data)||void 0===r?void 0:r.server)||void 0===o?void 0:o.proxyPort},null===(i=Au(e))||void 0===i?void 0:i.authCredentials);return c.username&&c.password&&(c.proxyAuthorizationHeader=(a=c.username,s=c.password,"Basic "+btoa(a+":"+s))),c},i=function(){var e=(null==Us?void 0:Us.time)||0,t=Date.now();if(e>t)return e-t<ti.fromSeconds(10)&&hi(Vs(!0)),null==Us?void 0:Us.credentials}();if(i)return o(i);var a=function(e){return Vs(!0).then((function(t){return t?o(t):wi().then((function(t){return e>0?Vi(400).then((function(){return a(e-1)})):((null==t?void 0:t.uid)?qu(new Error(po("Error").t(Zu||(Zu=Eu(["Server not found"],["Server not found"]))))):Gu(!0),{type:"direct"})}))}))};return a(3)},handleProxyAuthentication:function(e){var t,n;return Pu(this,void 0,void 0,(function(){var r,o;return Ou(this,(function(i){switch(i.label){case 0:return e.isProxy?Ba(e)?[2,{cancel:!0}]:(r=e.challenger.host)===(null===(n=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost)||Nu[r]?[4,Vs()]:[3,2]:[3,2];case 1:return[2,(o=i.sent())&&Au(o)||{cancel:!0}];case 2:return[2,void 0]}}))}))},checkConnectingState:function(e){var t,n;if(this.proxyEnabled){var r=null===(t=null==pu?void 0:pu.data)||void 0===t?void 0:t.server,o=(null==r?void 0:r.name)||"";du("connected",{server:r,error:pu.data.error}),Ta("on","".concat(po("Label").t(Qu||(Qu=Eu(["Protected"],["Protected"])))," - ").concat(o))}else Date.now()-e>ti.fromSeconds(30)&&qu((null===(n=pu.data)||void 0===n?void 0:n.error)||new Error("Connection timeout"))}},Ru={name:"loggedout",initializedAt:0,init:function(){return Pu(this,void 0,void 0,(function(){return Ou(this,(function(e){switch(e.label){case 0:return Gs(),pu.data={},Ta("loggedOut"),du("logged-out"),[4,ac()];case 1:return e.sent(),[2]}}))}))},checkConnectingState:function(e){Date.now()-e>ti.fromSeconds(5)&&du("logged-out")}},Mu={name:"off",initializedAt:0,init:function(e){var t;return Pu(this,void 0,void 0,(function(){var n;return Ou(this,(function(r){switch(r.label){case 0:return Gs(),pu.data={},(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.error)&&(pu.data.error=n),du("disconnected",{error:n}),Ta(n?"error":"off",n&&Zo(n)),[4,ac()];case 1:return r.sent(),[2]}}))}))},refreshState:function(){return Pu(this,void 0,void 0,(function(){var e;return Ou(this,(function(t){switch(t.label){case 0:return(e=pu.data.server&&Date.now()-this.initializedAt>ti.fromSeconds(3))?[4,sc()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return e?[4,Hu(pu.data)]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},checkConnectingState:function(e){var t;Date.now()-e>ti.fromSeconds(5)&&du("disconnected",{error:(null===(t=pu.data)||void 0===t?void 0:t.error)||new Error("Connection initialization timeout")})}};function $u(e){var t,n,r,o=pu||void 0;pu=Object.assign({data:{}},e,{initializedAt:Date.now()}),Jo("Switch state to "+pu.name,pu.data),null===(t=pu.init)||void 0===t||t.call(pu,o),null===(n=pu.refreshState)||void 0===n||n.call(pu),hi(us.setValue(null===(r=pu.data)||void 0===r?void 0:r.server))}function Uu(){$u(Mu)}function Gu(e){var t=this;$u(Ru),mi.get().then((function(n){return Pu(t,void 0,void 0,(function(){return Ou(this,(function(t){return lu(),uu(),hi(mi.remove()),hi(gi.remove()),hi(xi()),Ec(),zc(),e&&(null==n?void 0:n.uid)&&hi(ea("auth",{method:"DELETE"},void 0,n)),[2]}))}))})),Nc("logged-out",po("Info").t(el||(el=Eu(["Logged out"],["Logged out"])))),Jo("Logged out")}function qu(e){Nc("connected-server",e?"".concat(Zo(e)):po("Info").t(tl||(tl=Eu(["Disconnected"],["Disconnected"])))),cl().data.error=e,$u(Mu)}function Fu(e,t,n){var r;return Pu(this,void 0,void 0,(function(){var o,i;return Ou(this,(function(a){switch(a.label){case 0:return o=!!(e.Features&ec.SECURE_CORE),i=t.Label||"",[4,Hu({server:{id:e.ID,name:e.Name,exitIp:t.ExitIP,entryCountry:e.EntryCountry,exitCountry:e.ExitCountry,exitCity:(null===(r=e.Translations)||void 0===r?void 0:r.City)||e.City,exitEnglishCity:e.City,secureCore:o,proxyHost:g||t.Domain,proxyPort:o?x||w:w+(!_&&/^\d+$/.test(i)?parseInt(i,10):0),bypassList:n}})];case 1:return a.sent(),[2]}}))}))}function Hu(e){var t,n;return Pu(this,void 0,void 0,(function(){var r,o;return Ou(this,(function(i){switch(i.label){case 0:return r=Bu,o=[e],[4,us.get()];case 1:return[2,r.apply(void 0,o.concat([null===(n=null===(t=i.sent())||void 0===t?void 0:t.value)||void 0===n?void 0:n.name]))]}}))}))}function Bu(e,t){var n,r;return Pu(this,void 0,void 0,(function(){var o,i;return Ou(this,(function(a){return delete pu.data.error,Object.assign(pu.data,e),$u(ju),o=null===(n=null==e?void 0:e.server)||void 0===n?void 0:n.name,i=null===(r=null==e?void 0:e.server)||void 0===r?void 0:r.exitCity,t&&t===o||Nc("connected-server",o?i?po("Info").t(nl||(nl=Eu(["Connected to "," in ",""],["Connected to "," in ",""])),o,i):po("Info").t(rl||(rl=Eu(["Connected to ",""],["Connected to ",""])),o):po("Info").t(ol||(ol=Eu(["Connected"],["Connected"])))),[2]}))}))}function Vu(){return pu&&"loggedout"!==pu.name}function zu(){return pu&&"on"===pu.name}function Yu(){return Pu(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,c,u,l,f,d;return Ou(this,(function(p){switch(p.label){case 0:return e=C.item("auto-connect"),t=C.item("secure-core"),[4,su()];case 1:return(n=p.sent())?[4,Promise.all([Yc(),Pc(),e.getDefined({value:!0}),hu.getDefined({value:[]}),t.getDefined({value:!1})])]:[2];case 2:return r=Tu.apply(void 0,[p.sent(),5]),o=r[0],i=r[1],a=r[2],s=r[3],c=r[4],(null==o?void 0:o.connected)&&(null==a?void 0:a.value)?(u=fs(n),l=Wc(i.filter(mu(u,c)).filter((function(e){return u>=e.Tier})),o,(function(e){var t=Oc(e);return t?[t]:[]})),l[0]?(f=("random"===o.pick?l[Math.floor(Math.random()*l.length)]:Rc(l,u))||l[0],(null==(d=Mc(f))?void 0:d.Domain)?[4,Fu(f,d,bu(u,s.value))]:[3,4]):[3,4]):[3,4];case 3:p.sent(),p.label=4;case 4:return[2]}}))}))}var Wu,Ju,Ku,Xu,Zu,Qu,el,tl,nl,rl,ol,il=!1,al=[];function sl(){return Pu(this,void 0,void 0,(function(){return Ou(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Sa()];case 1:return[2,e.sent()?Mu:Ru];case 2:return e.sent(),[2,Ru];case 3:return[2]}}))}))}function cl(){var e=this;return pu||(Jo("New state creation"),pu={data:{}},us.get().then((function(t){return Pu(e,void 0,void 0,(function(){var e,n;return Ou(this,(function(r){switch(r.label){case 0:return(e=null==t?void 0:t.value)?[4,Bu({server:e},e.name)]:[3,2];case 1:case 4:return r.sent(),[2];case 2:return Ko(null==t?void 0:t.value),n=$u,[4,sl()];case 3:return n.apply(void 0,[r.sent()]),[4,Yu()]}}))}))})).finally((function(){il=!0,al.forEach((function(e){e()})),al=[]}))),pu}var ul,ll=function(e){var t,n;return null===(n=null===(t=pu)||void 0===t?void 0:t.handleProxyRequest)||void 0===n?void 0:n.call(t,e)},fl=function(){var e=chrome.proxy;if(!e)return!1;var t=e.onRequest;return!t||(t.hasListener(ll)||t.addListener(ll,{urls:["<all_urls>"]}),!0)},dl=function(){return dl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},dl.apply(this,arguments)},pl={vivaldi:{id:"4",welcomePage:"https://vivaldi.com/protonvpn/welcome/"}},hl=(ul=void 0,function(){if(!ul)for(var e in ul={},pl){var t=pl[e];ul["".concat(t.id)]=dl({name:e},t)}return ul}),vl=function(e){return hl()["".concat(e)]},yl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},bl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ml=function(e){return yl(void 0,void 0,void 0,(function(){return bl(this,(function(t){return[2,new Promise((function(t){var r,o,i=null===(o=null===(r=n.g[e])||void 0===r?void 0:r.protonvpn)||void 0===o?void 0:o.getStatus;"function"!=typeof i?t({oauthAllowed:!1,loggedInUser:!1,signupButton:!1}):i((function(n){var r;"boolean"==typeof(null==n?void 0:n.isLoggedIn)?t({partnerId:null===(r=pl[e])||void 0===r?void 0:r.id,oauthAllowed:!0,loggedInUser:n.isLoggedIn,signupButton:n.canSignUp||!1}):t({oauthAllowed:!1,loggedInUser:!1,signupButton:!1})}))}))]}))}))},gl=function(){return yl(void 0,void 0,void 0,(function(){var e,t;return bl(this,(function(n){switch(n.label){case 0:return e=Object.keys(pl),[4,Promise.all(e.map(ml))];case 1:return t=n.sent().filter((function(e){return e.oauthAllowed})),[2,t[0]||{oauthAllowed:!1,loggedInUser:!1,signupButton:!1}]}}))}))},wl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},_l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},xl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Sl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},El=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},kl=!1,Pl=[],Ol=C.item("servers-count",e.LOCAL),Tl=function(){return xl(void 0,void 0,void 0,(function(){var e,t;return Sl(this,(function(n){switch(n.label){case 0:if(kl)return[2,new Promise((function(e,t){Pl.push([e,t])}))];kl=!0,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,oa("vpn/servers-count")];case 2:return e=n.sent(),hi(Ol.setValue(e)),Pl.forEach((function(t){(0,El(t,1)[0])(e)})),[2,e];case 3:throw t=n.sent(),Pl.forEach((function(e){(0,El(e,2)[1])(t)})),t;case 4:return Pl=[],kl=!1,[7];case 5:return[2]}}))}))},Il=function(){return xl(void 0,void 0,void 0,(function(){var e,t,n;return Sl(this,(function(r){switch(r.label){case 0:return[4,Ol.get()];case 1:if(e=r.sent(),t=fc(e),e&&t<bs())return[2,e.value];if(e&&t<2*bs())return hi(Tl()),[2,e.value];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Tl()];case 3:return[2,r.sent()];case 4:if(n=r.sent(),null==e?void 0:e.value)return[2,e.value];throw n;case 5:return[2]}}))}))},Cl=function(e,t){void 0===t&&(t=!0);var n,r=(n=e,btoa(n).trim()).replace(/\+/g,"-").replace(/\//g,"_");return t?r.replace(/=/g,""):r},Dl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Nl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ll={signup:"2"},Al=function(t){var n=t.host,r=t.action,o=t.partnerId,i=t.independent;return Dl(void 0,void 0,void 0,(function(){var t,a,s;return Nl(this,(function(c){switch(c.label){case 0:return t=Cl(function(e){for(var t=[],n=16384,r=e.length,o=0;o<r;o+=n)t.push(String.fromCharCode.apply(String,e.subarray(o,o+n<r?o+n:r)));return t.join("")}(crypto.getRandomValues(new Uint8Array(32)))),a={partnerId:o,independent:i},[4,C.setItem("f".concat(t),a,e.LOCAL)];case 1:return c.sent(),s={app:"proton-vpn-browser-extension",appVersion:Zi(),state:t,t:r&&Ll[r]||"1",plan:"vpn2024"},o&&(s.partnerId=o),i&&(s.independent="1"),[2,"".concat(n,"/authorize?").concat(new URLSearchParams(s).toString())]}}))}))},jl=function(){return jl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jl.apply(this,arguments)},Rl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ml=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},$l=function(e,t,n){return Rl(void 0,void 0,void 0,(function(){var r,o,i,a,s;return Ml(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,(r=null===(i=browser.scripting)||void 0===i?void 0:i.executeScript)?r(jl({target:{tabId:e,allFrames:!0}},t())):null===(s=(a=browser.tabs).executeScript)||void 0===s?void 0:s.call(a,e,{code:n()})];case 1:return c.sent(),[3,3];case 2:return o=c.sent(),Yo(o),[3,3];case 3:return[2]}}))}))},Ul=function(){return Ul=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ul.apply(this,arguments)},Gl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ql=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Fl=n.g||window;Fl.browser||(Fl.browser=chrome);var Hl=C.item("tabs",e.LOCAL),Bl=function(e){var t,n;!function(e){hi(Gl(void 0,void 0,void 0,(function(){var t,n,r,o;return ql(this,(function(i){switch(i.label){case 0:return n=(t=Hl).set,r=[{}],[4,Hl.load({})];case 1:return[4,n.apply(t,[Ul.apply(void 0,[Ul.apply(void 0,r.concat([i.sent()])),(o={},o[e]=!0,o)])])];case 2:return[2,i.sent()]}}))})))}(e),hi(null===(n=(t=browser.tabs).executeScript)||void 0===n?void 0:n.call(t,e,{code:"\n\t\t\tchrome.runtime.connect();\n\t\t\twindow.addEventListener('message', (event) => {\n\t\t\t\tif (event.source != window) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tchrome.runtime.sendMessage({...event.data, tabId: ".concat(JSON.stringify(e),"});\n\t\t\t}, false);\n\t\t")}))},Vl=function(e,t){return Gl(void 0,void 0,void 0,(function(){var n,r,o,i,a,s;return ql(this,(function(c){switch(c.label){case 0:return t?(n=t.partnerId?vl(t.partnerId):void 0,o=(r=Promise).all,e?(i=[e],[3,3]):[3,1]):[2];case 1:return s=(a=Object).keys,[4,Hl.load({})];case 2:i=s.apply(a,[c.sent()]),c.label=3;case 3:return[4,o.apply(r,[i.map((function(e){return Gl(void 0,void 0,void 0,(function(){var r;return ql(this,(function(o){switch(o.label){case 0:return e=Number(e),r=null==n?void 0:n.welcomePage,[4,$l(e,(function(){return{func:function(e,t){t&&(location.href=t),window.postMessage(e)},args:[t,r]}}),(function(){return"\n\t\t\t\t\t".concat(r?"location.href = ".concat(JSON.stringify(r),";"):"","\n\t\t\t\t\twindow.postMessage(").concat(JSON.stringify(t),");\n\t\t\t\t")}))];case 1:return o.sent(),[2]}}))}))}))])];case 4:return c.sent(),hi(Hl.set({})),[2]}}))}))},zl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Yl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Wl={},Jl=function(e,t){return zl(void 0,void 0,void 0,(function(){var n,r;return Yl(this,(function(o){switch(o.label){case 0:if(n="string"==typeof e?{url:e}:e,r=t||n.url){if(Wl[r])throw new Error("Url already open");Wl[r]=!0,setTimeout((function(){delete Wl[r]}),800)}return[4,browser.tabs.create(n)];case 1:return[2,o.sent()]}}))}))},Kl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Xl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Zl=function(e){var t=void 0===e?{}:e,n=t.action,r=t.partnerId,o=t.independent;return Kl(void 0,void 0,void 0,(function(){var e;return Xl(this,(function(t){switch(t.label){case 0:return[4,is("openForkTab")];case 1:if(t.sent())throw new Error("Fork in progress");return as("openForkTab",500),e=Jl,[4,Al({host:s,action:n,partnerId:r,independent:o})];case 2:return e.apply(void 0,[t.sent(),"fork"]).then((function(e){e.id&&Bl(e.id);var t=function(n){var r,o;e.id===n&&(browser.tabs.onRemoved.removeListener(t),null===(o=null===(r=browser.action)||void 0===r?void 0:r.openPopup)||void 0===o||o.call(r))};browser.tabs.onRemoved.addListener(t)})),[2]}}))}))},Ql=["http://*/*","https://*/*","ftp://*/*","ws://*/*","wss://*/*","https://account.protonvpn.com/*","https://account.proton.me/*"];"https://account.proton.me"!==s&&Ql.push(s+"/*");var ef,tf,nf,rf,of,af,sf,cf,uf,lf,ff,df,pf,hf,vf={permissions:["proxy"],origins:Ql},yf=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},bf=void 0,mf=0,gf=function(e){bf||(bf=6553);var t,n=function(e,t){var n=Math.floor(e/t)*t;return n===bf?n-100:n}(bf,100),r=new Intl.NumberFormat("en-US",t).format(n);e&&"querySelectorAll"in e&&e.querySelectorAll(".incentive-paragraph").forEach((function(e){e.innerHTML=po("Info").plural(n,function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new uo(e,t)}(ef||(ef=yf(["High performance Swiss VPN that protects your privacy. Maximum security, more than "," server and no restrictions."],["High performance Swiss VPN that protects your privacy. Maximum security, more than "," server and no restrictions."])),r),"High performance Swiss VPN that protects your privacy. Maximum security, more than ".concat(r," servers and no restrictions."))}))},wf=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},_f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},xf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Sf=function(){if(Date.now()-mf>ti.fromHours(3))return Il().then((function(e){var t;return t=e.Servers,bf=t,mf=Date.now(),gf(),e}))},Ef=function(e,t,n,r){return _f(void 0,void 0,void 0,(function(){var o,i,a,s,c,u,l,f,d,p,h,y,b,m,g,w,_;return xf(this,(function(x){switch(x.label){case 0:return e&&t?((r=!(void 0!==r&&!r||!chrome.proxy))&&chrome.permissions.contains(vf,(function(r){r||kf(e,t,n,!1)})),o=function(e){return function(t){if(t){s.classList.add("update-extension"),s.innerHTML=po("Action").t(nf||(nf=wf(["Update"],["Update"])));var n=(null==t?void 0:t.Error)||Zo(t);i[0]&&(i[0].classList.remove("incentive-paragraph"),i[0].innerHTML=" "+n),i[1]&&(i[1].style.display="none"),a&&(a.style.display="none");var r=new Error(e+": "+n);r.previous=t,li(r)}}},null===(_=Sf())||void 0===_||_.catch(o("prepareSigningView")),i=e.querySelectorAll("p"),a=e.querySelector("button.sign-up-button"),s=e.querySelector("button.sign-in-button"),c=e.querySelector("a.sign-in-link"),s.classList.remove("update-extension"),u=function(e){void 0===e&&(e=""),s.innerHTML=e||(r?po("Action").t(rf||(rf=wf(["Sign in"],["Sign in"]))):po("Action").t(of||(of=wf(["Next"],["Next"]))))},[4,gl()]):[2,Zl()];case 1:return l=x.sent(),f=l.oauthAllowed,d=l.signupButton,p=l.partnerId,u(f?po("Action").t(af||(af=wf(["Sign in with Vivaldi"],["Sign in with Vivaldi"]))):""),c.style.display=f?"inline":"none",f?((h=e.querySelector(".sign-up-button-box"))&&!d&&(h.style.display="none"),e.classList.add("partner"),y="img/partner-welcome-image-dark@2x.svg",b=new Image,[4,new Promise((function(e){b.onload=e,b.onerror=e,b.src=y,setTimeout(e,1e3)}))]):[3,3];case 2:x.sent(),e.querySelectorAll("img.welcome-background").forEach((function(e){e.src=y})),(m=e.querySelector("h1"))&&(m.innerText=po("Title").t(sf||(sf=wf(["Proton VPN for Vivaldi"],["Proton VPN for Vivaldi"])))),(g=e.querySelector(".incentive-paragraph"))&&(g.innerText=po("Info").t(cf||(cf=wf(["Protect yourself online with Proton's free highspeed VPN."],["Protect yourself online with Proton's free highspeed VPN."])))),x.label=3;case 3:if(e.style.display="block",t.style.display="none",n&&(n.style.display="none"),w=function(e){return _f(void 0,void 0,void 0,(function(){var t;return xf(this,(function(n){switch(n.label){case 0:return t=setTimeout((function(){window.close()}),200),[4,browser.permissions.request(vf)];case 1:return n.sent()?(r||hi(jo(Do.PROXY)),clearTimeout(t),[4,Zl({partnerId:e})]):[2];case 2:return n.sent(),window.close(),[2]}}))}))},s.addEventListener("click",(function(){return _f(void 0,void 0,void 0,(function(){return xf(this,(function(e){switch(e.label){case 0:return s.classList.contains("update-extension")?(hi(Jl((/^moz-extension:/.test(location.href)?{name:"Firefox",type:"firefox",pluginsUrl:"https://addons.mozilla.org/firefox/addon/proton-vpn-firefox-extension"}:{name:"Chrome",type:"chromium",pluginsUrl:"chrome://extensions/"}).pluginsUrl)),window.close(),[2]):[4,w(p)];case 1:return e.sent(),[2]}}))}))})),c&&c.addEventListener("click",(function(){return _f(void 0,void 0,void 0,(function(){return xf(this,(function(e){switch(e.label){case 0:return[4,w(void 0)];case 1:return e.sent(),[2]}}))}))})),setTimeout((function(){s.scrollIntoView()})),i[0]){if(!r)return i[0].classList.remove("incentive-paragraph"),i[0].innerHTML="<b>".concat(po("Info").t(uf||(uf=wf(["Allow VPN permissions"],["Allow VPN permissions"]))),"</b><br><br>")+po("Info").t(lf||(lf=wf(["To get started, youll need to enable VPN permissions on your browser."],["To get started, youll need to enable VPN permissions on your browser."])))+"<br><br>"+po("Info").t(ff||(ff=wf(["Press <b>Next</b>, then click <b>Allow</b> on the pop-up from your browser."],["Press <b>Next</b>, then click <b>Allow</b> on the pop-up from your browser."])))+"<br><br>"+po("Info").t(df||(df=wf(["Then just click the Proton VPN icon to sign in."],["Then just click the Proton VPN icon to sign in."]))),[2];!function(e,t,n){if(n)return t.classList.add("partner-subtitle"),t.classList.remove("incentive-paragraph"),void(t.innerText=po("Info").t(tf||(tf=yf(["Protect yourself online with Proton's free highspeed VPN."],["Protect yourself online with Proton's free highspeed VPN."]))));t.classList.add("incentive-paragraph"),gf(e)}(e,i[0],f)}return r&&v?(!f&&i[1]&&(i[1].style.display="",i[1].innerHTML=po("Action").t(pf||(pf=wf(["New to Proton?"],["New to Proton?"])))),a&&(a.style.display="",a.innerHTML=po("Action").t(hf||(hf=wf(["Create an account"],["Create an account"]))),a.addEventListener("click",(function(){return _f(void 0,void 0,void 0,(function(){return xf(this,(function(e){switch(e.label){case 0:return[4,Zl({action:"signup",partnerId:p})];case 1:return e.sent(),null===window||void 0===window||window.close(),[2]}}))}))}))),qi().then(o("getUpdateError")),[2]):(i[1]&&(i[1].style.display="none"),a&&(a.style.display="none"),[2])}}))}))},kf=function(e,t,n,r){hi(Ef(e,t,n,r))},Pf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Of=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Tf=n.g||window;Tf.browser||(Tf.browser=chrome);var If=function(e){return void 0===e&&(e={}),Pf(void 0,void 0,void 0,(function(){var t,n,r;return Of(this,(function(o){switch(o.label){case 0:return Sf(),[4,ki(e)];case 1:return o.sent(),t=document.getElementById("spinner"),n=document.getElementById("sign-in-view"),r=document.getElementById("logged-view"),n&&r?(kf(n,r,t),[2,!1]):(du("logged-out"),[2,!1])}}))}))},Cf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Df=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Nf=n.g||window;Nf.browser||(Nf.browser=chrome);var Lf,Af,jf=function(t){var n=t.state,r=t.selector;return Cf(void 0,void 0,void 0,(function(){var t,o,i,a,s,c;return Df(this,(function(u){switch(u.label){case 0:return t="f".concat(n),[4,C.getItem(t,void 0,e.LOCAL)];case 1:if(!(o=u.sent()))throw new Error("Invalid state");return hi(C.removeItem(t)),[4,oa("auth/sessions/forks/".concat(r))];case 2:return i=u.sent(),a=i.UID,s=i.AccessToken,c=i.RefreshToken,[2,{session:{accessToken:s,refreshToken:c,uid:a},forkState:o}]}}))}))},Rf=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Mf=function(){return Mf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Mf.apply(this,arguments)},$f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Uf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Gf=function(e){return $f(void 0,void 0,void 0,(function(){var t,n,r,o,i,s,c,u,l,f,d,p,h;return Uf(this,(function(v){switch(v.label){case 0:if(!e||"object"!=typeof e)return[2];if(n=(t=e).payload,r=t.extension,o=t.token,r&&r!==a)return[2];if(i=o?{token:o}:{},!n||"object"!=typeof n)return[2,Mf(Mf({},i),{type:"error"})];s=n.selector,c=n.persistent,u=n.state,v.label=1;case 1:return v.trys.push([1,4,,5]),[4,jf({state:u,selector:s})];case 2:return l=v.sent(),f=l.session,d=l.forkState,f.persistent=c,f.partnerId=d.partnerId||void 0,[4,ki(f)];case 3:return v.sent(),hi(cu()),[2,Mf(Mf({},i),{type:"success",partnerId:f.partnerId,payload:{title:po("Info").t(Lf||(Lf=Rf(["You're signed in"],["You're signed in"]))),message:po("Info").t(Af||(Af=Rf(["Open the Proton VPN browser extension to continue"],["Open the Proton VPN browser extension to continue"])))}})];case 4:return p=v.sent(),Wo(p),h=Zo(p),[2,Mf(Mf(Mf({},i),{type:"error"}),h?{payload:{message:h}}:{})];case 5:return[2]}}))}))},qf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ff=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Da("messaging");var Hf,Bf,Vf,zf,Yf=function(e){return qf(void 0,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,u,l;return Ff(this,(function(f){switch(f.label){case 0:switch(t=e.type,n=e.data,t){case No.FORK:return[3,1];case Lo.USER:return[3,4];case Lo.PM_USER:return[3,7];case Io.SIGN_OUT:return[3,10];case Io.SWITCH_ACCOUNT:return[3,12];case Lo.STATE:return[3,14];case Io.DISCONNECT:return[3,15];case Io.CONNECTING:return[3,16];case Io.CONNECT:return[3,17];case No.FORGET_ERROR:return[3,19];case No.LOG:return[3,20];case Do.PROXY:return[3,21];case Co.BYPASS_LIST:return[3,22]}return[3,23];case 1:return r=Vl,o=[e.tabId],[4,Gf(e)];case 2:return[4,r.apply(void 0,o.concat([f.sent()]))];case 3:return f.sent(),[2,null];case 4:case 7:return[4,wi()];case 5:if(!(null===(i=f.sent())||void 0===i?void 0:i.uid))throw new Error("No session");return[4,cu()];case 6:case 9:return[2,f.sent()];case 8:if(!(null===(a=f.sent())||void 0===a?void 0:a.uid))throw new Error("No session");return[4,(d=!0,void 0===d&&(d=!1),Xc(void 0,void 0,void 0,(function(){var e,t,n;return Zc(this,(function(r){switch(r.label){case 0:return[4,wi()];case 1:return(null===(n=r.sent())||void 0===n?void 0:n.uid)?[4,Sa()]:[2,void 0];case 2:r.sent(),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,eu()];case 4:return(e=r.sent())||!d?[2,e]:[3,6];case 5:if(t=r.sent(),!d||!ba(t))throw t;return[3,6];case 6:return[4,Ni()];case 7:return r.sent(),[4,eu()];case 8:return[2,r.sent()]}}))})))];case 10:return Gu(!0),[4,If()];case 11:case 13:case 18:return f.sent(),[3,23];case 12:return Gu(!1),[4,If()];case 14:return[2,cl().data];case 15:return qu(),[3,23];case 16:return null===(c=(s=cl()).checkConnectingState)||void 0===c||c.call(s,n.connectionAttemptTime),[3,23];case 17:return[4,Fu(n.logical,n.server,n.bypassList)];case 19:return delete cl().data.error,[3,23];case 20:return Ho(n),[3,23];case 21:return fl(),[3,23];case 22:return null===(l=(u=cl()).setOption)||void 0===l||l.call(u,t,n),[3,23];case 23:return[2,void 0]}var d}))}))},Wf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Jf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Kf=function(e){return Wf(void 0,void 0,void 0,(function(){var t;return Jf(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),[4,Yf(e)];case 1:return[2,n.sent()];case 2:return(t=n.sent())instanceof Pi?(Gu(!1),[4,If()]):[3,4];case 3:return n.sent(),[2,{error:t}];case 4:return[2,{error:t}];case 5:return[2]}}))}))},Xf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Zf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Qf=function(){var e=0,t=new Date,n=ds()?ti.fromHours(1):ti.fromMinutes(15);zi(n,n/5,(function(){return Xf(void 0,void 0,void 0,(function(){var n,r,o;return Zf(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n=ji,r=["logicalUpdate"],[4,gc(void 0,void 0,void 0,(function(){var e,t,n,r;return wc(this,(function(o){switch(o.label){case 0:return[4,xc.get()];case 1:return e=o.sent(),t=fc(e),!e||t>vs()?[4,kc(e)]:[3,3];case 2:return[2,o.sent()];case 3:return[4,Ts("vpn/loads")];case 4:return n=o.sent().LogicalServers,r={},n.forEach((function(e){r[e.ID]=e})),e.value.forEach((function(e){r[e.ID]&&Tc(Object.assign(e,r[e.ID]))})),[4,xc.set(e)];case 5:return o.sent(),[2,e.value]}}))}))];case 1:return n.apply(void 0,r.concat([i.sent()])),t=new Date,e=0,[3,3];case 2:return o=i.sent(),++e>5&&Yo("Loagical load update failed after "+e+" attempts, last update was ",t,o),[3,3];case 3:return[2]}}))}))}))},ed=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},td=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},nd=function(e){return ed(void 0,void 0,void 0,(function(){return td(this,(function(t){switch(t.label){case 0:return Ta("loggedOut"),Gs(),[4,su(!0)];case 1:return t.sent()?e?[4,Hu({server:e})]:[3,3]:[2];case 2:case 4:return t.sent(),[2];case 3:return Uu(),[4,Yu()]}}))}))},rd=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},od=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},id=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},ad=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},sd=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},cd=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ud=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Da("background"),Ks(void 0,void 0,void 0,(function(){return Xs(this,(function(e){switch(e.label){case 0:return[4,oc(ic("localhost",9))];case 1:return[2,e.sent()]}}))})),di(),Ka(),n.g.browser||(n.g.browser=chrome),browser.runtime.onMessage.addListener((function(e){var t=new Promise((function(t){return Wf(void 0,void 0,void 0,(function(){var n;return Jf(this,(function(r){switch(r.label){case 0:return[4,Kf(e)];case 1:return n=r.sent(),t({received:!0,success:!n||!("object"==typeof n&&n.error),result:n}),[2]}}))}))}));if("broadcast"!==e.respondTo)return t;t.then((function(t){hi(browser.runtime.sendMessage(browser.runtime.id,{type:"answer:"+e.requestId,respondTo:"none",data:function(){try{return JSON.parse(JSON.stringify(t))}catch(e){return{result:{error:"".concat(e)}}}}()}))}))})),browser.runtime.onMessageExternal.addListener((function(e,t){return Wf(void 0,void 0,void 0,(function(){var n,r,o;return Jf(this,(function(i){switch(i.label){case 0:return e.type!==No.FORK?[3,5]:[4,Gf(e)];case 1:return n=i.sent(),(r=(null==n?void 0:n.partnerId)?null===(o=vl(n.partnerId))||void 0===o?void 0:o.welcomePage:void 0)?[4,$l(t.tab.id,(function(){return{func:function(e){location.href=e},args:[r]}}),(function(){return"location.href = ".concat(JSON.stringify(r),";")}))]:[3,4];case 2:return i.sent(),[4,Vi(500)];case 3:i.sent(),i.label=4;case 4:return[2,n];case 5:return[2]}}))}))})),setTimeout((function(){return rd(void 0,void 0,void 0,(function(){var e,t,n;return od(this,(function(r){switch(r.label){case 0:return Ko("Init state",(new Error).stack),[4,new Promise((function(e){il?e():(al.push(e),cl())}))];case 1:return r.sent(),[4,us.get()];case 2:if(e=null===(n=r.sent())||void 0===n?void 0:n.value,Ko(e),e?zu():Vu())return[3,6];Ko(e?"Not connected":"Not logged in"),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,nd(e)];case 4:return r.sent(),[3,6];case 5:return t=r.sent(),ji("changeState",{state:"disconnected",server:void 0,error:t}),[3,6];case 6:return zu()?[3,8]:[4,ac()];case 7:r.sent(),r.label=8;case 8:return setInterval((function(){return pi((function(){var e,t;null===(t=(e=cl()).refreshState)||void 0===t||t.call(e)}))}),ti.fromSeconds(1)),function(){var e,t=function(){Es().catch((function(e){(e instanceof Pi||e.logout)&&Gu(!1)}))},n=ps();zi(n,n/10,t),null===(e=navigator.connection)||void 0===e||e.addEventListener("change",t)}(),Qf(),[2]}}))}))}),1),fl(),hi(no(void 0,void 0,void 0,(function(){var e,t;return ro(this,(function(n){switch(n.label){case 0:if("en_US"===(e=wo()))return yo(e,{}),[2];n.label=1;case 1:return n.trys.push([1,3,,8]),[4,bo(e)];case 2:return n.sent(),[3,8];case 3:if(n.sent(),(t=go(e.split("_")[0]||""))===e)return yo(e,{}),[2];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,bo(t)];case 5:return n.sent(),[3,7];case 6:return n.sent(),yo("en_US",{}),[3,7];case 7:return[3,8];case 8:return[2]}}))}))),browser.runtime.onInstalled.addListener((function(e){return wl(void 0,void 0,void 0,(function(){var t;return _l(this,(function(n){switch(n.label){case 0:return[4,yl(void 0,void 0,void 0,(function(){return bl(this,(function(e){switch(e.label){case 0:return[4,gl()];case 1:return[2,e.sent().oauthAllowed]}}))}))];case 1:return n.sent()?[2]:"install"===e.reason?[3,2]:[3,4];case 2:return t=browser.runtime.getURL("/onboarding.html"),[4,browser.tabs.create({url:t})];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))})),browser.proxy.settings.onChange.addListener((function(e){return ad(void 0,void 0,void 0,(function(){var t,n,r;return sd(this,(function(o){switch(o.label){case 0:return(t=zu())?[3,2]:[4,ls()];case 1:t=o.sent(),o.label=2;case 2:return t?("controlled_by_this_extension"===e.levelOfControl||qu(new Error((i=e.levelOfControl,a=null===(r=null===(n=e.value)||void 0===n?void 0:n.rules)||void 0===r?void 0:r.singleProxy,s=(null==a?void 0:a.host)||"",c=(null==a?void 0:a.port)||"",u=Boolean(s||c),l=u?"".concat(s,":").concat(c):"","controlled_by_other_extensions"===i?u?po("Info").t(Hf||(Hf=id(["Disconnected by another extension, it connected to ",""],["Disconnected by another extension, it connected to ",""])),l):po("Info").t(Bf||(Bf=id(["Disconnected by another extension"],["Disconnected by another extension"]))):u?po("Info").t(Vf||(Vf=id(["Disconnected, settings were overridden to ",""],["Disconnected, settings were overridden to ",""])),l):po("Info").t(zf||(zf=id(["Disconnected, settings were overridden"],["Disconnected, settings were overridden"])))))),[2]):[2]}var i,a,s,c,u,l}))}))})),browser.idle.onStateChanged.addListener((function(e){return cd(void 0,void 0,void 0,(function(){var t,n,r,o,i;return ud(this,(function(a){switch(a.label){case 0:return function(e){Na=e}(e),"active"!==e?[2]:"on"===(null==(t=cl())?void 0:t.name)||-1!==(null===(o=null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.error)||void 0===o?void 0:o.httpStatus)?[3,3]:[4,us.get()];case 1:return(n=null===(i=a.sent())||void 0===i?void 0:i.value)?[4,Hu({server:n})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}))}()}();